<?phpclass Dashboard extends CI_Controller{    public $mass;    public $mass2;    public function __construct()    {        parent::__construct();        $this->load->library('pagination');        $this->load->library('form_validation');    if($this->session->userdata('is_logged_in')==0){            redirect('login');        }        $this->load->helper(array('url','text','permission','form','download'));//---------------------------------------------        if($_SESSION['group_number']==0){            redirect('Dash/home');        }        $this->load->model('Groups');        $this->main_groups=$this->Groups->fetch_groups("","");        $this->groups=$this->Groups->get_group($_SESSION["group_number"]);        //-------------------------        $this->load->model('Contact');        $this->mass = $this->Contact->getallinbox();        $this->load->model('Question');        $this->mass2 = $this->Question->getallinbox();            }    private  function test($data=array()){              echo "<pre>";        print_r($data);        echo "</pre>";        die;    }    private  function  ara_date(){        $nameday=date("l");        $day=date("d");        $namemonth=date("m");                $year=date("Y");        switch ($nameday)        {            case "Saturday":                $nameday="السبت";                break;            case "Sunday":                $nameday="الأحد";                break;            case "Monday":                $nameday="الاثنين";                break;            case "Tuesday":                $nameday="الثلاثاء";                break;            case "Wednesday":                $nameday="الأربعاء";                break;            case "Thursday":                $nameday="الخميس";                break;            case "Friday":                $nameday="الجمعة";                break;        }        switch ($namemonth)        {            case 1:                $namemonth="يناير";                break;            case 2:                $namemonth="فبراير";                break;            case 3:                $namemonth="مارس";                break;            case 4:                $namemonth="إبريل";                break;            case 5:                $namemonth="مايو";                break;            case 6:                $namemonth="يونيو";                break;            case 7:                $namemonth="يوليو";                break;            case 8:                $namemonth="اغسطس";                break;            case 9:                $namemonth="سبتمبر";                break;            case 10:                $namemonth="اكتوبر";                break;            case 11:                $namemonth="نوفمبر";                break;            case 12:                $namemonth="ديسمبر";                break;        }        return "$nameday $day $namemonth $year";    }    /**     * @param $type     success     * @param $type     wiring     * @param $type     error     */    private function message($type,$text){      if($type =='success') {          return $this->session->set_flashdata('message','<div class="alert alert-success alert-dismissible shadow" data-sr="wait 0s, then enter bottom and hustle 100%"><button type="button" class="close pull-left" data-dismiss="alert">×</button><h4 class="text-lg"><i class="fa fa-check icn-xs"></i> تم بنجاح ...</h4><p>'.$text.'!</p></div>');      }elseif($type=='wiring'){          return $this->session->set_flashdata('message','<div class="alert alert-warning alert-dismissible" data-sr="wait 0.6s, then enter bottom and hustle 100%"><button type="button" class="close pull-left" data-dismiss="alert">×</button><h4 class="text-lg"><i class="fa fa-exclamation-triangle icn-xs"></i> تحذير هام ...</h4><p>'.$text.'</p></div>');      }elseif($type=='error'){          return  $this->session->set_flashdata('message', '<div class="alert alert-danger alert-dismissible" data-sr="wait 0.3s, then enter bottom and hustle 100%"><button type="button" class="close pull-left" data-dismiss="alert">×</button><h4 class="text-lg"><i class="fa fa-exclamation-circle icn-xs"></i> خطآ ...</h4><p>'.$text.'</p></div>');      }    }    private function thumb($data)    {        $config['image_library'] = 'gd2';        $config['source_image'] =$data['full_path'];        $config['new_image'] = 'uploads/thumbs/'.$data['file_name'];        $config['create_thumb'] = TRUE;        $config['maintain_ratio'] = TRUE;        $config['thumb_marker']='';        $config['width'] = 275;        $config['height'] = 250;        $this->load->library('image_lib', $config);        $this->image_lib->resize();    }    private  function upload_image($file_name){    $config['upload_path'] = 'uploads/images';    $config['allowed_types'] = 'gif|Gif|ico|ICO|jpg|JPG|jpeg|JPEG|BNG|png|PNG|bmp|BMP|WMV|wmv|MP3|mp3|FLV|flv|SWF|swf';    $config['max_size']    = '1024*8';    $config['encrypt_name']=true;    $this->load->library('upload',$config);    if(! $this->upload->do_upload($file_name)){      return  false;    }else{        $datafile = $this->upload->data();        $this->thumb($datafile);       return  $datafile['file_name'];    }  //  unlink($datafile['full_path']);}    //////////////////////////////////    private  function upload_file($file_name){        $config['upload_path'] = 'uploads/files';        $config['allowed_types'] = 'gif|Gif|ico|ICO|jpg|JPG|jpeg|JPEG|BNG|png|PNG|bmp|BMP|WMV|wmv|MP3|mp3|FLV|flv|SWF|swf|pdf|PDF|xls|xlsx|mp4|doc|docx|txt|rar|tar.gz|zip';        $config['max_size']    = '1024*8';        //$config['encrypt_name']=true;        $config['overwrite'] = true;        $this->load->library('upload',$config);        if(! $this->upload->do_upload($file_name)){            return  false;        }else {            $datafile = $this->upload->data();            return $datafile['file_name'];        }    }    ////////////////////end of excel library option    private function url (){     unset($_SESSION['url']);        $this->session->set_flashdata('url','http://' . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI']);    }    ////////////////////////////////*  private  function sendmail($from,$name,$to=array(),$cc=false,$bcc=false,$subject,$message,$attach=false)    {        $this->load->library('email');        $this->email->from($from, $name);        $this->email->to($to);        $this->email->cc($cc);        $this->email->bcc($bcc);        $this->email->subject($subject);        $this->email->message($message);        $this->email->attach($attach);        if(!$this->email->send())        {            // return show_error($this->email->print_debugger());             return false;        }        else        {           return true;        }    }*/    /**@     * @param $method     * @param $recordcount     * @param $per_page     * @return array     */    private function pagnate($method,$recordcount,$per_page){        $config = array();        $config["base_url"] = base_url() . "dashboard/".$method;        $config["total_rows"] = $recordcount;        $config["per_page"] = $per_page;        $config["uri_segment"] = 3;        $config['use_page_numbers'] = TRUE;        $config['full_tag_open'] = '<ul class="pagination" >';        $config['full_tag_close'] = '</ul>';        $config['first_link'] = '<li class="disabled"><a href="#">«</a></li>';        $config['last_link'] = '<li><a href="#">»</a></li>';        $config['first_tag_open'] = '<li>';        $config['first_tag_close'] = '</li>';        $config['prev_link'] = '&laquo';        $config['prev_tag_open'] = '<li class="prev">';        $config['prev_tag_close'] = '</li>';        $config['next_link'] = '&raquo';        $config['next_tag_open'] = '<li>';        $config['next_tag_close'] = '</li>';        $config['last_tag_open'] = '<li>';        $config['last_tag_close'] = '</li>';        $config['cur_tag_open'] = '<li class="active"><a href="#">';        $config['cur_tag_close'] = '</a></li>';        $config['num_tag_open'] = '<li>';        $config['num_tag_close'] = '</li>';        $this->pagination->initialize($config);        return $config;          }        /////////////////////////main page    public function  index(){       //$this->test(setpermition());        $this->url();        $data['title'] ='لوحة التحكم';                $this->load->model('Users');        $data['users_num'] = $this->Users->record_count();                $this->load->model('News');        $data['news_num'] = $this->News->record_count_all(0);        $data['journal_num'] = $this->News->record_count_all(1);                $this->load->model('Reports');        $data['report_num'] = $this->Reports->record_count();                $this->load->model('Album');        $data['album_num'] = $this->Album->record_count();        $data['subview'] = 'admin/main';        $this->load->view('index', $data);    }    public function addgroup(){        $this->load->model('Groups');        $this->load->model('Difined_model');        if ($this->input->post('add_groupe')) {            $this->Groups->addGroup();            $this->message('success','تمت إضافة المجموعة بنجاح');            redirect('dashboard/addgroup', 'refresh');        }        $data["font_icon"]=$this->Difined_model->select_all("font_icons","id","","id","DESC");        $data["groups_table"] = $this->Groups->fetch_groups('', '');        $data['title'] = 'إضافة مجموعة تحكم';        $data['metakeyword'] = 'اعداددات الموقع ';        $data['metadiscription'] = '';        $data['subview'] = 'admin/groups/group';        $this->load->view('index', $data);    }    public function update_group_by_id($id){        $this->load->model('Groups');        $this->load->model('Difined_model');        $data['result_id'] = $this->Groups->getgroupbyid($id);        if ($this->input->post('edit_groupe')) {            $this->Groups->updateGroup($id);            $this->message('success','تمت تعديل المجموعة بنجاح');            redirect('dashboard/addgroup', 'refresh');        }        $data["font_icon"]=$this->Difined_model->select_all("font_icons","id","","id","DESC");        $data['title'] = 'تعديل بيانات مجموعة تحكم';        $data['metakeyword'] = 'اعداددات الموقع ';        $data['metadiscription'] = '';        $data['subview'] = 'admin/groups/group';        $this->load->view('index', $data);    }    public function delete_group_by_id($id)    {        $this->db->where('group_id', $id);        $this->db->delete('groups');        redirect('dashboard/addgroup');    }    /*  public function addgroup(){          $this->url();          $this->load->model('Groups');          if ($this->input->post('add_groupe') == true) {              if ($this->Groups->addGroup()) {                  $this->message('success','تمت إضافة المجموعة بنجاح');              } else {                  $this->message('error','خطأ تأكد من البيانات ');              }          }          $config = array();$config["base_url"] = base_url() . "dashboard/addgroup";          $config["total_rows"] = $this->Groups->record_count();          //$config["per_page"] = 10;$config["uri_segment"] = 3;$config['use_page_numbers'] = TRUE;$config['full_tag_open'] = '<ul class="pagination">';$config['full_tag_close'] = '</ul>';$config['first_link'] = '<li class="disabled"><a href="#">«</a></li>';$config['last_link'] = '<li><a href="#">»</a></li>';$config['first_tag_open'] = '<li>';$config['first_tag_close'] = '</li>';$config['prev_link'] = '&laquo';$config['prev_tag_open'] = '<li class="prev">';$config['prev_tag_close'] = '</li>';$config['next_link'] = '&raquo';$config['next_tag_open'] = '<li>';$config['next_tag_close'] = '</li>';$config['last_tag_open'] = '<li>';$config['last_tag_close'] = '</li>';$config['cur_tag_open'] = '<li class="active"><a href="#">';$config['cur_tag_close'] = '</a></li>';$config['num_tag_open'] = '<li>';$config['num_tag_close'] = '</li>';          //$this->pagination->initialize($config);          //$page = ($this->uri->segment(3)) ? $this->uri->segment(3) : 0;          //$data["groups"] = $this->Groups->fetch_groups($config["per_page"], $page);          $data["groups"] = $this->Groups->fetch_groups('', '');          $data["links"] = $this->pagination->create_links();          $data['title'] = 'إضافة مجموعة تحكم';          $data['metakeyword'] = 'اعداددات الموقع ';          $data['metadiscription'] = '';          $data['subview'] = 'admin/groups/group';          $this->load->view('index', $data);      }      public function delete_group_by_id($id)      {          $this->db->where('group_id', $id);          $this->db->delete('groups');          redirect('dashboard/addgroup');      }      public function update_group_by_id()      {          $this->url();          $data['id'] = $this->uri->segment(3);          $this->load->model('Groups');          $data['result_id'] = $this->Groups->getgroupbyid($data['id']);          if ($this->input->post('edit_groupe')) {              $update = array('group_title' => $this->input->post('group_title'),                  'group_order' => $this->input->post('group_order'),                  'group_icon_code' => $this->input->post('group_icon_code'),                  'group_link' => $this->input->post('group_link'));              if ($this->Groups->updateGroup($data['id'], $update) == 1) {                  $this->message('success','تم تعديل البيان بنجاح');                  redirect('dashboard/addgroup', 'refresh');              } else {                  $this->message('error','خطأ فى التعديل حاول مرة اخرى');              }          }          $data['title'] = 'تعديل بيانات مجموعة تحكم';          $data['metakeyword'] = 'اعداددات الموقع ';          $data['metadiscription'] = '';          $data['subview'] = 'admin/groups/group';          $this->load->view('index', $data);      } */    ////////////////////////pages    /************** pages *********************/    public function add_page()    {        $this->load->model('Pages');        $this->load->model('Groups');        $this->load->model('Difined_model');        if ($this->input->post('add_page') ) {            $this->Pages->insert();            $this->message('success','تم اضافة الصفحة بنجاح');            redirect('dashboard/add_page', 'refresh');        }        $data['pages']=$this->Pages->all_pages();        $data['pages_name']=$this->Pages->main_groups_name();        $data["font_icon"]=$this->Difined_model->select_all("font_icons","id","","id","DESC");        $data["main_groups"]=$this->Groups->level_groups();        $data['title'] = 'إضافة صفحات مجموعات التحكم  ';        $data['metakeyword'] = 'اعداددات الموقع ';        $data['metadiscription'] = 'اعداددات الموقع ';        $data['subview'] = 'admin/groups/pages';        $this->load->view('index', $data);    }    public function update_pages_by_id($id)    {        $this->load->model('Pages');        $this->load->model('Groups');        $this->load->model('Difined_model');        $data['page_data'] = $this->Pages->get_by_id($id);        if ($this->input->post('edit_page')) {            $this->Pages->update($id);            $this->message('success','تم العملية بنجاح');            redirect('dashboard/add_page', 'refresh');        }        $data['pages']=$this->Pages->all_pages();        $data['pages_name']=$this->Pages->main_groups_name();        $data["font_icon"]=$this->Difined_model->select_all("font_icons","id","","id","DESC");        $data["main_groups"]=$this->Groups->level_groups();        $data['title'] = 'تعديل بيانات صفحات التحكم';        $data['metakeyword'] = 'اعداددات الموقع ';        $data['metadiscription'] = '';        $data['subview'] = 'admin/groups/pages';        $this->load->view('index', $data);    }    public function delete_page_by_id($id)    {        $this->db->where('page_id', $id);        $this->db->delete('pages');        redirect('dashboard/add_page');    }    /*******************************************/    /*    public function add_page()    {        $this->url();        $this->load->model('Pages');        if ($this->input->post('add_page') == true) {            if ($this->Pages->insert() == true) {               $this->message('success','تم اضافة الصفحة بنجاح');            } else {                $this->message('error','خطأ فى الادخال حاول مرة اخرى');            }        }        $config=$this->pagnate('add_page',$this->Pages->record_count(),50);        $data["pages"] = $this->Pages->select($config["per_page"],$config["uri_segment"]);        $data["links"] = $this->pagination->create_links();        $data['groups']=$this->Pages->get_all_groups();        $data['title'] = 'إضافة صفحات مجموعات التحكم  ';$data['metakeyword'] = 'اعداددات الموقع ';$data['metadiscription'] = '';        $data['subview'] = 'admin/groups/pages';        $this->load->view('index', $data);    }    public function update_pages_by_id()    {        $this->url();        $data['pages']='';        $data['id'] = $this->uri->segment(3);        $this->load->model('Pages');        $data['page_data'] = $this->Pages->get_by_id($data['id']);        if ($this->input->post('edit_page')) {            $update = array('page_title' => $this->input->post('page_title'),                'page_link' => $this->input->post('page_link'),                'page_order' => $this->input->post('page_order'),                'page_icon_code'=>$this->input->post('page_icon_code'),                'group_id_fk' => $this->input->post('group_id_fk'));            if ($this->Pages->update($data['id'], $update) == 1) {                $this->message('success','تم العملية بنجاح');                redirect('dashboard/add_page', 'refresh');            } else {                $this->message('error','خطأ فى عملية التعديل حاول مرة اخرى');            }        }        $data['groups']=$this->Pages->get_all_groups();        $data['title'] = 'تعديل بيانات صفحات التحكم';        $data['metakeyword'] = 'اعداددات الموقع ';        $data['metadiscription'] = '';        $data['subview'] = 'admin/groups/pages';        $this->load->view('index', $data);    }    public function delete_page_by_id($id)    {        $this->db->where('page_id', $id);        $this->db->delete('pages');        redirect('dashboard/add_page');    }    */    //////////////////////////////roles    /**************** roles **************/    public  function  create_role(){        $this->load->model('Groups');        $this->load->model('Roles');        $this->load->model('Difined_model');        $this->load->model('Permission');        $data["results_main"]=$this->Groups->get_categories();        $data["user_in"]=$this->Permission->user_in();        if ($this->input->post('add_role') == true) {            // $this->test($_POST);            $this->Permission->insert_user_role();            $this->message('success','تم إضافة الدور بنجاح');            redirect('dashboard/create_role', 'refresh');        }        $data['users']=$this->Difined_model->select_all("users","user_id","","user_id","DESC");        $data['per_table']=$this->Difined_model->select_all("permissions","user_id","","user_id","DESC");//        $data["user_name"]=$this->Permission->users_name();        $data['title'] = 'إضافة أدوار التحكم';        $data['metakeyword'] = 'إعدادات الموقع ';        $data['metadiscription'] = '';        $data['subview'] = 'admin/users/roles';        $this->load->view('index', $data);    }    public function update_role($id){        $this->load->model('Groups');        $this->load->model('Roles');        $this->load->model('Difined_model');        $this->load->model('Permission');        $data['users']=$this->Difined_model->select_all("users","user_id","","user_id","DESC");        $data["results_main"]=$this->Groups->get_categories();        $data['user_data'] = $this->Difined_model->getByArray("users",array("user_id"=>$id));        $data["user_permations"]=$this->Permission->select_per($id);        if ($this->input->post('edit_role')) {            $this->Difined_model->delete('permissions',array("user_id"=>$id));            $this->Permission->insert_user_role();            $this->message('success','تم التعديل بنجاح');            redirect('dashboard/create_role', 'refresh');        }        $data['title'] = 'تعديل دور التحكم';        $data['metakeyword'] = 'اعداددات الموقع ';        $data['metadiscription'] = '';        $data['subview'] = 'admin/users/roles';        $this->load->view('index', $data);    }    public  function  deleteRole($id){        $this->load->model('Roles');        $this->Roles->delete($id);        redirect('dashboard/create_role');    }   /*    public  function  create_role(){        $this->url();        $data['title'] = 'إضافة أدوار التحكم';$data['metakeyword'] = 'إعدادات الموقع ';$data['metadiscription'] = '';    $data['subview'] = 'admin/users/roles';    $this->load->model('Roles');    if ($this->input->post('add_role') == true) {        if ($this->Roles->insert() == true) {            $this->message('success','تم إضافة الدور بنجاح');        } else {            $this->message('error','خطأ فى الإدخال حاول مرة اخرى');        }    }    $data['roles']=$this->Roles->select();    $this->load->view('index', $data);}    public  function  deleteRole($id){    $this->load->model('Roles');    $this->Roles->delete($id);    redirect('dashboard/create_role');}    public function update_role($id){        $this->url();        $data['roles']='';        $this->load->model('Roles');    $data['role_data'] = $this->Roles->get_by_id($id);      if ($this->input->post('edit_role')) {            if ($this->Roles->update($id) == 1) {                $data['message'] = $this->message('success','تم التعديل بنجاح');                redirect('dashboard/create_role', 'refresh');            } else {                $this->message('error','خطأ فى حفظ التعديلات  حاول مرة اخرى');            }        }        $data['title'] = 'تعديل دور التحكم';        $data['metakeyword'] = 'اعداددات الموقع ';        $data['metadiscription'] = '';        $data['subview'] = 'admin/users/roles';        $this->load->view('index', $data);    }*/    //////////////////////users            public function add_user(){        $this->url();        $this->load->model('Users');        $this->load->model('Difined_model');         $this->load->model('Doctors');                                        $data['all_empolyee']=$this->Difined_model->select_all("employees","id","","id","DESC");         $data['all_doctor']=$this->Difined_model->select_all("doctor","id","","id","DESC");              //  $this->test($data['all_empolyee']);       // $data["emp_in"]=$this->Users->emp_in();        if ($this->input->post('add_user') == 'add_user') {            /////////////////////            $file_name='user_photo';            $file= $this->upload_image($file_name);            if($file == false){                $file='user.png';                $this->message('error','نوع الملفات غير مسموح به');            }            //////////////////////////////////            if ($this->Users->insert($file)) {                $this->message('success','تم إضافة مستخدم بنجاح');            } else {                $this->message('error','لم تتم العملية بشكل سليم تأكد من البيانات ');            }        }        $config = array();$config["base_url"] = base_url() . "dashboard/add_user";        $config["total_rows"] = $this->Users->record_count();$config["per_page"] = 20;$config["uri_segment"] = 3;$config['use_page_numbers'] = TRUE;$config['full_tag_open'] = '<ul class="pagination">';$config['full_tag_close'] = '</ul>';$config['first_link'] = '<li class="disabled"><a href="#">«</a></li>';$config['last_link'] = '<li><a href="#">»</a></li>';$config['first_tag_open'] = '<li>';$config['first_tag_close'] = '</li>';$config['prev_link'] = '&laquo';$config['prev_tag_open'] = '<li class="prev">';$config['prev_tag_close'] = '</li>';$config['next_link'] = '&raquo';$config['next_tag_open'] = '<li>';$config['next_tag_close'] = '</li>';$config['last_tag_open'] = '<li>';$config['last_tag_close'] = '</li>';$config['cur_tag_open'] = '<li class="active"><a href="#">';$config['cur_tag_close'] = '</a></li>';$config['num_tag_open'] = '<li>';$config['num_tag_close'] = '</li>';$this->pagination->initialize($config);$page = ($this->uri->segment(3)) ? $this->uri->segment(3) : 0;        $data["users"] = $this->Users->fetch_users($config["per_page"], $page);        $data["links"] = $this->pagination->create_links();        if($this->input->post('num'))        {            $this->load->model('Patient');            $this->load->model('Doctors');            $data['result'] = $this->Doctors->records_select_user();            $data['departs']=$this->Patient->departs(1);            $data['result22'] = $this->Doctors->records_select_user2($_POST['id']);            $this->load->view('admin/users/load', $data);        }        else{            $data['title'] = 'إضافة مستخدم جديد';            $data['metakeyword'] = 'اعدادات المستخدمين';            $data['metadiscription'] = '';            $data['subview'] = 'admin/users/users';            $this->load->view('index', $data);        }    }      /*  public function add_user(){     if($this->input->post('id') != ""){    $this->load->model('Doctors');        $this->load->model('Patient');    $data['departs']=$this->Patient->departs(2);        $data['doc']=$this->Doctors->records_select_user();       $this->load->view('admin/x/s',$data); }else{        $this->url();        $this->load->model('Users');        if ($this->input->post('add_user') == 'add_user') {            /////////////////////            $file_name='user_photo';            $file= $this->upload_image($file_name);            if($file == false){                $file='user.png';                $this->message('error','نوع الملفات غير مسموح به');            }            //////////////////////////////////            if ($this->Users->insert($file)) {                                $this->message('success','تم إضافة مستخدم بنجاح');            } else {                $this->message('error','لم تتم العملية بشكل سليم تأكد من البيانات ');            }        }        $config = array();$config["base_url"] = base_url() . "dashboard/add_user";        $config["total_rows"] = $this->Users->record_count();$config["per_page"] = 20;$config["uri_segment"] = 3;$config['use_page_numbers'] = TRUE;$config['full_tag_open'] = '<ul class="pagination">';$config['full_tag_close'] = '</ul>';$config['first_link'] = '<li class="disabled"><a href="#">«</a></li>';$config['last_link'] = '<li><a href="#">»</a></li>';$config['first_tag_open'] = '<li>';$config['first_tag_close'] = '</li>';$config['prev_link'] = '&laquo';$config['prev_tag_open'] = '<li class="prev">';$config['prev_tag_close'] = '</li>';$config['next_link'] = '&raquo';$config['next_tag_open'] = '<li>';$config['next_tag_close'] = '</li>';$config['last_tag_open'] = '<li>';$config['last_tag_close'] = '</li>';$config['cur_tag_open'] = '<li class="active"><a href="#">';$config['cur_tag_close'] = '</a></li>';$config['num_tag_open'] = '<li>';$config['num_tag_close'] = '</li>';$this->pagination->initialize($config);$page = ($this->uri->segment(3)) ? $this->uri->segment(3) : 0;        $data["users"] = $this->Users->fetch_users($config["per_page"], $page);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'إضافة مستخدم جديد';        $data['metakeyword'] = 'اعدادات المستخدمين';        $data['metadiscription'] = '';        $data['subview'] = 'admin/users/users';        $this->load->view('index', $data); }    }*/    public function delete_user_by_id($id){        $this->load->model('Users');        $this->Users->delete($id);        redirect('dashboard/add_user');    }         public function update_user_by_id($id){        $this->url();        $this->load->model('Users');        $this->load->model('Difined_model');         $data['all_doctor']=$this->Difined_model->select_all("doctor","id","","id","DESC");         $data['user_row']=$this->Users->display($id);                        $this->load->model('Doctors');        $this->load->model('Patient');        $data['all_empolyee']=$this->Difined_model->select_all("employees","id","","id","DESC");        $data["emp_in"]=$this->Users->emp_in();        $data["doc_in"]=$this->Users->doc_in();                $data['departs']=$this->Patient->departs(1);        $data['result'] = $this->Doctors->records_select_user();        $data['result2'] = $this->Doctors->records_select_user2($data['user_row']['doctor_id']);        $data['users']='';        if ($this->input->post('edit_user')) {            $file_name='user_photo';            $file= $this->upload_image($file_name);            if ($this->Users->update($id,$file)) {                $this->message('success','تم تعديل البيانات');                redirect('dashboard/add_user', 'refresh');            } else {                $this->message('error','خطأ فى حفظ التعديلات  حاول مرة أخرى');            }        }        $data['title'] = 'تعديل بيانات المستخدم';        $data['metakeyword'] = 'اعداددات المستخدمين ';        $data['metadiscription'] = '';        $data['subview'] = 'admin/users/users';        $this->load->view('index', $data);    }      /*        public function update_user_by_id($id){if($this->input->post('id') != ""){    $this->load->model('Doctors');    $data['doc']=$this->Doctors->records_select_user();               $this->load->view('admin/x/s',$data);}else{    $this->load->model('Patient');    $data['departs']=$this->Patient->departs(2);       $this->load->model('Doctors');    $data['doc']=$this->Doctors->records_select_user();  $data['all']=$this->Doctors->select();    $data['all_doctor']=$this->Doctors->select();              $this->url();        $this->load->model('Users');        $data['user_row']=$this->Users->display($id);        $data['users']='';        if ($this->input->post('edit_user')) {            $file_name='user_photo';            $file= $this->upload_image($file_name);            if ($this->Users->update($id,$file)) {                                         $this->message('success','تم تعديل البيانات');                redirect('dashboard/add_user', 'refresh');            } else {                $this->message('error','خطأ فى حفظ التعديلات  حاول مرة أخرى');            }        }                $data['title'] = 'تعديل بيانات المستخدم';        $data['metakeyword'] = 'اعداددات المستخدمين ';        $data['metadiscription'] = '';        $data['subview'] = 'admin/users/users';        $this->load->view('index', $data);}    }*/    public function patron(){        $this->url();        $this->load->model('Users');        if ($this->input->post('edit_user')) {            $file= $this->upload_image('user_photo');                        $this->Users->update($_SESSION['user_id'],$file);                           $this->message('success','تم تعديل بياناتك الشخصية ');                redirect('dashboard', 'refresh');        }        $data['title'] = 'تعديل بيانات المستخدم';        $data['metakeyword'] = 'اعداددات المستخدمين ';        $data['metadiscription'] = '';        $data['subview'] = 'admin/users/patron';        $this->load->view('index', $data);    }    public  function systembacup(){        $this->load->dbutil();        $this->load->helper(array('file', 'download'));        $backup =& $this->dbutil->backup();        $filename = 'backup-' . time() . ' .zip';        write_file('/asisst/backup/databases/' . $filename, $backup);        force_download($filename, $backup);    }    public  function backup(){        $data['title'] = 'النسخ الاحتياطى للبيانات';        $data['metakeyword'] = 'اعدادات الحماية';        $data['metadiscription'] = '';        $data['subview'] = 'admin/backup';        $this->load->view('index',$data);    }    public function mailbox(){$this->load->model("Mailbox");    if($this->input->post('send')=='send' && $this->input->post('to')!=""){        $file_name='attachment';        $file= $this->upload_file($file_name);      if($this->Mailbox->sendmessage($file)==true){            $this->message('success','تم ارسال الرسالة بنجاح');        }else{            $this->message('error','خطا فى الارسال من فضلك تاكد من البيانات');        }    }    $data['users']=$this->Mailbox->getallusers();    $data['messages']=$this->Mailbox->getallmessage();   //$this->test($data['messages']);    $data['title'] = 'البريد الإليكترونى';    $data['metakeyword'] = 'إعدادات البريد الاليكترونى ';    $data['metadiscription'] = '';    $data['subview'] = 'admin/message/mailbox';    $this->load->view('index',$data);}    public function readmessage($id){        $this->load->model("Mailbox");        $data["result"]=$this->Mailbox->getmessagebyid($id);        $data['title'] = 'عرض رسالئل البريد الاليكترونى ';        $data['metakeyword'] = 'إعدادات البريد الاليكترونى ';        $data['metadiscription'] = '';        $data['subview'] = 'admin/message/readmessage';        $this->load->view('index',$data);    }  /*  public function viewmessage($id){        $this->load->model("Contact");        $data["result"]=$this->Contact->getmessagebyid($id);        $this->Contact->readmessagebyid($id);        $data['title'] = 'عرض رسائل البريد الألكتروني';        $data['metakeyword'] = 'إعدادات البريد الألكتروني';        $data['metadiscription'] = '';        $data['subview'] = 'admin/contact/viewmessage';                $this->load->view('index',$data);               //redirect('dashboard/viewmessage/'.$id.'');    }*/                        public function viewshakwa(){        $this->load->model('Shakwa');        $config=$this->pagnate('shakwa',$this->Shakwa->record_count(),10);        $page = ($this->uri->segment(3)) ? $this->uri->segment(3) : 0;            $page = (($page*10)-10);            if($page<0)                $page = 0;        $data['records1']=$this->Shakwa->select_active($config["per_page"],$page);        $data['records0']=$this->Shakwa->select_unactive($config["per_page"],$page);             $data["links"] = $this->pagination->create_links();                $data["links"] = $this->pagination->create_links();        $data['title'] = 'إدارة الشكاوي والاقتراحات';        $data['metakeyword'] = 'الشكاوي والاقتراحات';        $data['metadiscription'] = '';        $data['subview'] = 'admin/contact/viewshakwa';        $this->load->view('index', $data);    }////////////////////////////////// sherif/////////////    /** *  *  * ABOUT *  *  * */  public function addabout(){        $this->load->model('About');        if ($this->input->post('add_about')){            $file_name='img';            $file= $this->upload_image($file_name);            $this->About->insert($file,1);            $this->message('success','إضافة رؤية ورسالة');            redirect('dashboard/addabout','refresh');        }        $data['records']=$this->About->select('',1);        $data['title'] = 'إضافة رؤية ورسالة';        $data['metakeyword'] = 'إعدادات رؤية ورسالة';        $data['metadiscription'] = '';        $data['subview'] = 'admin/about/about';        $this->load->view('index', $data);    }    public function deleteabout($id){        $this->load->model('About');        $this->About->delete($id);        redirect('dashboard/addabout');    }    public function updateabout($id){        $this->load->model('About');        if($this->input->post('update')){            $file_name='img';            $file= $this->upload_image($file_name);            $this->About->update($id,$file);            $this->message('success','تعديل رؤية ورسالة');            redirect('dashboard/addabout','refresh');        }        $data['result']=$this->About->getById($id);        $data['title'] = 'تعديل رؤية ورسالة';        $data['metakeyword'] = 'إعدادات رؤية ورسالة';        $data['metadiscription'] = '';        $data['subview'] = 'admin/about/about';        $this->load->view('index', $data);    }        public function suspendAbout($id,$clas){        $this->load->model('About');                    $this->About->suspend($id,$clas);            if($clas == 'danger')            $this->message('success','الرؤية والرسالة نشطة');            else            $this->message('success','الرؤية والرسالة غير نشطة');            redirect('dashboard/addabout');    }             public function add_about(){        $this->load->model('About');        if ($this->input->post('add_about')){            $file_name='img';            $file= $this->upload_image($file_name);            $this->About->insert($file,3);            $this->message('success','إضافة نبذة عن الماس');            redirect('dashboard/add_about','refresh');        }        $data['records']=$this->About->select('',3);        $data['title'] = 'إضافة نبذة عن الماس';        $data['metakeyword'] = 'إعدادات نبذة عن الماس';        $data['metadiscription'] = '';        $data['subview'] = 'admin/about/add_about';        $this->load->view('index', $data);    }    public function delete_about($id){        $this->load->model('About');        $this->About->delete($id);        redirect('dashboard/add_about');    }    public function update_about($id){        $this->load->model('About');        if($this->input->post('update')){            $file_name='img';            $file= $this->upload_image($file_name);            $this->About->update($id,$file);            $this->message('success','تعديل نبذة عن الماس');            redirect('dashboard/add_about','refresh');        }        $data['result']=$this->About->getById($id);        $data['title'] = 'تعديل نبذة عن الماس';        $data['metakeyword'] = 'إعدادات نبذة عن الماس';        $data['metadiscription'] = '';        $data['subview'] = 'admin/about/add_about';        $this->load->view('index', $data);    }        public function suspend_About($id,$clas){        $this->load->model('About');                    $this->About->suspend($id,$clas);            if($clas == 'danger')            $this->message('success','نبذة عن بانوراما نشطة');            else            $this->message('success','نبذة عن بانوراما غير نشطة');            redirect('dashboard/add_about');    }                 /** *  *  * نبذة عن الماس *  *  * */  public function addabout_almas(){        $this->load->model('About_almas');        if ($this->input->post('add_about')){            $file_name='img';            $file= $this->upload_image($file_name);            $this->About_almas->insert($file,1);            $this->message('success','إضافة رؤية ورسالة');            redirect('dashboard/addabout_almas','refresh');        }        $data['records']=$this->About_almas->select('',1);        $data['title'] = 'إضافة نبذة عن الماس';        $data['metakeyword'] = 'إعدادات نبذة عن الماس';        $data['metadiscription'] = '';        $data['subview'] = 'admin/about/about_almas';        $this->load->view('index', $data);    }    public function deleteabout_almas($id){        $this->load->model('About_almas');        $this->About_almas->delete($id);        redirect('dashboard/addabout_almas');    }    public function updateabout_almas($id){        $this->load->model('About_almas');        if($this->input->post('update')){            $file_name='img';            $file= $this->upload_image($file_name);            $this->About_almas->update($id,$file);            $this->message('success','تعديل نبذة عن الماس');            redirect('dashboard/addabout_almas','refresh');        }        $data['result']=$this->About_almas->getById($id);        $data['title'] = 'تعديل نبذة عن الماس';        $data['metakeyword'] = 'إعدادات تعديل نبذة عن الماس';        $data['metadiscription'] = '';        $data['subview'] = 'admin/about/about_almas';        $this->load->view('index', $data);    }        public function suspendAbout_almas($id,$clas){        $this->load->model('About_almas');                    $this->About_almas->suspend($id,$clas);            if($clas == 'danger')            $this->message('success','نبذة عن الماس نشطة');            else            $this->message('success','نبذة عن الماس غير نشطة');            redirect('dashboard/addabout_almas');    }            /** *  *  * قالوا عن الماس *  *  * */ public function add_service(){        $this->load->model('About');        if ($this->input->post('add_about')){            $file_name='img';            $file= $this->upload_image($file_name);            $this->About->insert($file,2);            $this->message('success','إضافة مقولة عن الماس');            redirect('dashboard/add_service','refresh');        }        $data['records']=$this->About->select('',2);        $data['title'] = 'إضافة مقولة عن الماس';        $data['metakeyword'] = 'إعدادات مقولة عن الماس';        $data['metadiscription'] = '';        $data['subview'] = 'admin/services/services';        $this->load->view('index', $data);    }    public function delete_service($id){        $this->load->model('About');        $this->About->delete($id);        redirect('dashboard/add_service');    }    public function update_service($id){        $this->load->model('About');        if($this->input->post('update')){            $file_name='img';            $file= $this->upload_image($file_name);            $this->About->update($id,$file);            $this->message('success','تعديل مقولة عن الماس');            redirect('dashboard/add_service','refresh');        }        $data['result']=$this->About->getById($id);        $data['title'] = 'تعديل مقولة عن الماس';        $data['metakeyword'] = 'إعدادات مقولة عن الماس';        $data['metadiscription'] = '';        $data['subview'] = 'admin/services/services';        $this->load->view('index', $data);    }        public function suspend_service($id,$clas){        $this->load->model('About');                    $this->About->suspend($id,$clas);            if($clas == 'danger')            $this->message('success','خدمة الجمعية نشطة');            else            $this->message('success','خدمة الجمعية غير نشطة');            redirect('dashboard/add_service');    }        /** *  *  * Manager_word *  *  * */ public function addmanager_word(){        $this->load->model('Manager_word');        if ($this->input->post('add')){            $this->Manager_word->insert(1);            $this->message('success','إضافة الكلمة');            redirect('dashboard/addmanager_word');        }        $config=$this->pagnate('addmanager_word',$this->Manager_word->record_count(),50);        $data['records']=$this->Manager_word->select($config["per_page"],1);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'إضافة كلمة رئيس مجلس الإدارة';        $data['metakeyword'] = 'إعدادات كلمة رئيس مجلس الإدارة';        $data['metadiscription'] = '';        $data['subview'] = 'admin/manager_word/manager_word';        $this->load->view('index', $data);    }    public function updatemanager_word($id){        $this->load->model('Manager_word');        if($this->input->post('update')){            $this->Manager_word->update($id);            $this->message('success','تعديل كلمة رئيس مجلس الإدارة');            redirect('dashboard/addmanager_word','refresh');        }        $data['result']=$this->Manager_word->getById($id);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'تعديل كلمة رئيس مجلس الإدارة';        $data['metakeyword'] = 'إعدادات كلمة رئيس مجلس الإدارة';        $data['metadiscription'] = '';        $data['subview'] = 'admin/manager_word/manager_word';        $this->load->view('index', $data);    }    /** *  *  * Main_data *  *  * */ public function add_main_data(){        $this->load->model('Main_data');        if ($this->input->post('add')){            $file_name='logo';            $file= $this->upload_image($file_name);            $this->Main_data->insert($file);            $this->message('success','إضافة البيانات الأساسية');            redirect('dashboard/add_main_data');        }        $config=$this->pagnate('add_main_data',$this->Main_data->record_count(),50);        $data['records']=$this->Main_data->select($config["per_page"],0);        if($this->input->post('num'))        {            if($this->input->post('num') != 0)            {                $page = $this->input->post('page');                $data['result'] = $this->input->post('num');                $this->load->view('admin/main_data/'.$page.'', $data);            }        }        else{        $data["links"] = $this->pagination->create_links();        $data['title'] = 'إضافة البيانات الأساسية';        $data['metakeyword'] = 'إعدادات البيانات الأساسية';        $data['metadiscription'] = '';        $data['subview'] = 'admin/main_data/main_data';        $this->load->view('index', $data);}    }        public function update_main_data($id){        $this->load->model('Main_data');        if($this->input->post('update')){            $file_name='logo';            $file= $this->upload_image($file_name);            $this->Main_data->update($id,$file);            $this->message('success','تعديل البيانات الأساسية');            redirect('dashboard/add_main_data','refresh');        }        $data['result']=$this->Main_data->getById($id);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'تعديل البيانات الأساسية';        $data['metakeyword'] = 'إعدادات البيانات الأساسية';        $data['metadiscription'] = '';        $data['subview'] = 'admin/main_data/main_data';        $this->load->view('index', $data);    }        public function delete($from,$id,$index){        $this->load->model('Main_data');        $this->Main_data->delete($from,$id,$index);        redirect('dashboard/update_main_data/'.$id.'');    }            /**     *      * News     *      * **/               public function add_news(){        $this->load->model('News');        if ($this->input->post('add_news')){                    for($x = 1 ; $x <= $this->input->post('photo_num') ; $x++)            {                $file_name='img'.$x;                $file[]= $this->upload_image($file_name);            }                        $this->News->insert($file);            $this->message('success','إضافة خبر');            redirect('dashboard/add_news','refresh');        }                $data['records']=$this->News->select('');                if($data['records']){        $this->load->model('Users');        for($r = 0 ; $r < count($data['records']) ; $r++)            $data['user'][$r]=$this->Users->display($data['records'][$r]->publisher);}                    if($this->input->post('num'))        {            if($this->input->post('num') != 0)            {                $data['result'] = $this->input->post('num');                $this->load->view('admin/news/photos', $data);            }        }        else{        $data['title'] = 'إضافة خبر';        $data['metakeyword'] = 'إعدادات الأخبار';        $data['metadiscription'] = '';        $data['subview'] = 'admin/news/news';        $this->load->view('index', $data);        }    }///////////////////////////////    public function delete_news($id){        $this->load->model('News');        $this->News->delete($id);        redirect('dashboard/add_news','refresh');    }    public function update_news($id){        $this->load->model('News');                if($this->input->post('update')){                        if($this->input->post('photo_num'))            {                if($this->input->post('photo_num') != 0)                {                    for($x = 1 ; $x <= $this->input->post('photo_num') ; $x++)                    {                        $file_name='img'.$x;                        $file[]= $this->upload_image($file_name);                    }                }            }            else                $file = '';                            $this->News->update($id,$file);            $this->message('success','تعديل الخبر');            redirect('dashboard/add_news','refresh');        }        $data['result']=$this->News->getById($id);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'تعديل خبر';        $data['metakeyword'] = 'إعدادات الأخبار';        $data['metadiscription'] = '';        $data['subview'] = 'admin/news/news';        $this->load->view('index', $data);    }        public function delete_photo($id,$index){        $this->load->model('News');        $this->News->delete_photo($id,$index);        redirect('dashboard/update_news/'.$id.'');    }        public function suspend_news($id,$clas){        $this->load->model('News');                    $this->News->suspend($id,$clas);            if($clas == 'danger')            $this->message('success','الخبر نشط');            else            $this->message('success','الخبر غير نشط');            redirect('dashboard/add_news');    }            /**     *      * Journalist     * **/               public function add_journalist(){        $this->load->model('Journalist');        if ($this->input->post('add_news')){                    for($x = 1 ; $x <= $this->input->post('photo_num') ; $x++)            {                $file_name='img'.$x;                $file[]= $this->upload_image($file_name);            }            $file_name='logo';            $file2= $this->upload_image($file_name);                        $this->Journalist->insert($file,$file2);            $this->message('success','إضافة خبر صحفي');            redirect('dashboard/add_journalist','refresh');        }        $config=$this->pagnate('add_journalist',$this->Journalist->record_count(),50);        $data['records']=$this->Journalist->select($config["per_page"]);                if($data['records']){        $this->load->model('Users');        for($r = 0 ; $r < count($data['records']) ; $r++)            $data['user'][$r]=$this->Users->display($data['records'][$r]->publisher);}                $data["links"] = $this->pagination->create_links();        $data['title'] = 'إضافة خبر صحفي';        $data['metakeyword'] = 'إعدادات الأخبار الصحفية';        $data['metadiscription'] = '';        $data['subview'] = 'admin/journalist/journalist';        $this->load->view('index', $data);    }    public function delete_journalist($id){        $this->load->model('News');        $this->News->delete($id);        redirect('dashboard/add_journalist','refresh');    }        public function suspend_journalist($id,$clas){        $this->load->model('News');                    $this->News->suspend($id,$clas);            if($clas == 'danger')            $this->message('success','الخبر نشط');            else            $this->message('success','الخبر غير نشط');            redirect('dashboard/add_journalist');    }        public function update_journalist($id){        $this->load->model('Journalist');                if($this->input->post('update')){                        if($this->input->post('photo_num'))            {                if($this->input->post('photo_num') != 0)                {                    for($x = 1 ; $x <= $this->input->post('photo_num') ; $x++)                    {                        $file_name='img'.$x;                        $file[]= $this->upload_image($file_name);                    }                }            }            else                $file = '';            $file_name='logo';            $file2= $this->upload_image($file_name);                            $this->Journalist->update($id,$file,$file2);            $this->message('success','تعديل الخبر الصحفي');            redirect('dashboard/add_journalist','refresh');        }        $data['result']=$this->Journalist->getById($id);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'تعديل خبر صحفي';        $data['metakeyword'] = 'إعدادات الأخبار الصحفية';        $data['metadiscription'] = '';        $data['subview'] = 'admin/journalist/journalist';        $this->load->view('index', $data);    }        public function delete_photo_($id,$index){        $this->load->model('News');        $this->News->delete_photo($id,$index);        redirect('dashboard/update_journalist/'.$id.'');    }          /**     *      * achieve     *      * **/               public function add_achieve(){        $this->load->model('Achieve');        if ($this->input->post('add_news')){                    for($x = 1 ; $x <= $this->input->post('photo_num') ; $x++)            {                $file_name='img'.$x;                $file[]= $this->upload_image($file_name);            }                        $this->Achieve->insert($file);            $this->message('success','إضافة عرض');            redirect('dashboard/add_achieve','refresh');        }                $data['records']=$this->Achieve->select('');                if($data['records']){        $this->load->model('Users');        for($r = 0 ; $r < count($data['records']) ; $r++)            $data['user'][$r]=$this->Users->display($data['records'][$r]->publisher);}                    if($this->input->post('num'))        {            if($this->input->post('num') != 0)            {                $data['result'] = $this->input->post('num');                $this->load->view('admin/news/photos', $data);            }        }        else{        $data['title'] = 'إضافة عرض';        $data['metakeyword'] = 'إعدادات عرض';        $data['metadiscription'] = '';        $data['subview'] = 'admin/news/achieve';        $this->load->view('index', $data);        }    }///////////////////////////////    public function delete_achieve($id){        $this->load->model('News');        $this->News->delete($id);        redirect('dashboard/add_achieve','refresh');    }    public function update_achieve($id){        $this->load->model('Achieve');        $this->load->model('News');                if($this->input->post('update')){                        if($this->input->post('photo_num'))            {                if($this->input->post('photo_num') != 0)                {                    for($x = 1 ; $x <= $this->input->post('photo_num') ; $x++)                    {                        $file_name='img'.$x;                        $file[]= $this->upload_image($file_name);                    }                }            }            else                $file = '';                            $this->Achieve->update($id,$file);            $this->message('success','تعديل عرض');            redirect('dashboard/add_achieve','refresh');        }        $data['result']=$this->News->getById($id);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'تعديل عرض';        $data['metakeyword'] = 'إعدادات عرض';        $data['metadiscription'] = '';        $data['subview'] = 'admin/news/achieve';        $this->load->view('index', $data);    }        public function delete_photo_achieve($id,$index){        $this->load->model('News');        $this->News->delete_photo($id,$index);        redirect('dashboard/update_achieve/'.$id.'');    }        public function suspend_achieve($id,$clas){        $this->load->model('News');                    $this->News->suspend($id,$clas);            if($clas == 'danger')            $this->message('success','العرض نشط');            else            $this->message('success','العرض غير نشط');            redirect('dashboard/add_achieve');    }    /** *  *  * clients *  *  * */  public function add_client(){        $this->load->model('Clients');        if ($this->input->post('add')){            $file_name='img';            $file= $this->upload_image($file_name);            $this->Clients->insert($file,1);            $this->message('success','إضافة عميل');            redirect('dashboard/add_client','refresh');        }        $data['records']=$this->Clients->select(1);        $data['title'] = 'إضافة عميل';        $data['metakeyword'] = 'إعدادات عميل';        $data['metadiscription'] = '';        $data['subview'] = 'admin/clients/clients';        $this->load->view('index', $data);    }    public function delete_client($id){        $this->load->model('Clients');        $this->Clients->delete($id);        redirect('dashboard/add_client');    }    public function update_client($id){        $this->load->model('Clients');        if($this->input->post('update')){            $file_name='img';            $file= $this->upload_image($file_name);            $this->Clients->update($id,$file);            $this->message('success','تعديل عميل');            redirect('dashboard/add_client','refresh');        }        $data['result']=$this->Clients->getById($id);        $data['title'] = 'تعديل عميل';        $data['metakeyword'] = 'إعدادات عميل';        $data['metadiscription'] = '';        $data['subview'] = 'admin/clients/clients';        $this->load->view('index', $data);    }        public function suspend_client($id,$clas){        $this->load->model('Clients');                    $this->Clients->suspend($id,$clas);            if($clas == 'danger')            $this->message('success',' العميل نشط');            else            $this->message('success',' العميل غير نشط');            redirect('dashboard/add_client');    }                                  /** *  *  * departments *  *  * */  public function add_depart(){        $this->load->model('Departs');        if ($this->input->post('add')){            $file_name='img';            $file= $this->upload_image($file_name);            $this->Departs->insert($file,1);            $this->message('success','إضافة قسم');            redirect('dashboard/add_depart','refresh');        }        $data['records']=$this->Departs->select(1);        $data['title'] = 'إضافة قسم';        $data['metakeyword'] = 'إعدادات الاقسام';        $data['metadiscription'] = '';        $data['subview'] = 'admin/departs/departs';        $this->load->view('index', $data);    }    public function delete_depart($id){        $this->load->model('Departs');        $this->Departs->delete($id);        redirect('dashboard/add_depart');    }    public function update_depart($id){        $this->load->model('Departs');        if($this->input->post('update')){            $file_name='img';            $file= $this->upload_image($file_name);            $this->Departs->update($id,$file);            $this->message('success','تعديل قسم');            redirect('dashboard/add_depart','refresh');        }        $data['result']=$this->Departs->getById($id);        $data['title'] = 'تعديل قسم';        $data['metakeyword'] = 'إعدادات الأقسام';        $data['metadiscription'] = '';        $data['subview'] = 'admin/departs/departs';        $this->load->view('index', $data);    }        public function suspend_depart($id,$clas){        $this->load->model('Departs');                    $this->Departs->suspend($id,$clas);            if($clas == 'danger')            $this->message('success',' القسم نشط');            else            $this->message('success',' القسم غير نشط');            redirect('dashboard/add_depart');    }      /** *  *  * company *  *  * */  public function add_company(){        $this->load->model('Clients');        if ($this->input->post('add')){            $file_name='img';            $file= $this->upload_image($file_name);            $this->Clients->insert($file,2);            $this->message('success','إضافة شركة');            redirect('dashboard/add_company','refresh');        }        $data['records']=$this->Clients->select(2);        $data['title'] = 'إضافة شركة';        $data['metakeyword'] = 'إعدادات شركة';        $data['metadiscription'] = '';        $data['subview'] = 'admin/company/company';        $this->load->view('index', $data);    }    public function delete_company($id){        $this->load->model('Clients');        $this->Clients->delete($id);        redirect('dashboard/add_company');    }    public function update_company($id){        $this->load->model('Clients');        if($this->input->post('update')){            $file_name='img';            $file= $this->upload_image($file_name);            $this->Clients->update($id,$file);            $this->message('success','تعديل شركة');            redirect('dashboard/add_company','refresh');        }        $data['result']=$this->Clients->getById($id);        $data['title'] = 'تعديل شركة';        $data['metakeyword'] = 'إعدادات شركة';        $data['metadiscription'] = '';        $data['subview'] = 'admin/company/company';        $this->load->view('index', $data);    }        public function suspend_company($id,$clas){        $this->load->model('Clients');                    $this->Clients->suspend($id,$clas);            if($clas == 'danger')            $this->message('success',' شركة نشطة');            else            $this->message('success',' شركة غير نشطة');            redirect('dashboard/add_company');    }           /** *  *  * departs *  *  * */  public function add_dep(){        $this->load->model('Departs');        if ($this->input->post('add')){            $this->Departs->insert();            $this->message('success','إضافة قسم');            redirect('dashboard/add_dep','refresh');        }        $data['records']=$this->Departs->select(2);        $data['title'] = 'إضافة قسم';        $data['metakeyword'] = 'إعدادات قسم';        $data['metadiscription'] = '';        $data['subview'] = 'admin/departs/departs';        $this->load->view('index', $data);    }    public function delete_dep($id){        $this->load->model('Departs');        $this->Departs->delete($id);        redirect('dashboard/add_dep');    }    public function update_dep($id){        $this->load->model('Departs');        if($this->input->post('update')){            $this->Departs->update($id);            $this->message('success','تعديل قسم');            redirect('dashboard/add_dep','refresh');        }        $data['result']=$this->Departs->getById($id);        $data['title'] = 'تعديل قسم';        $data['metakeyword'] = 'إعدادات قسم';        $data['metadiscription'] = '';        $data['subview'] = 'admin/departs/departs';        $this->load->view('index', $data);    }        public function suspend_dep($id,$clas){        $this->load->model('Departs');                    $this->Departs->suspend($id,$clas);            if($clas == 'danger')            $this->message('success',' القسم نشط');            else            $this->message('success',' القسم غير نشط');            redirect('dashboard/add_dep');    }       //////////////////// contact /*       public function contact(){        $this->load->model('Contact');        $config=$this->pagnate('contact',$this->Contact->record_count(),10);        $page = ($this->uri->segment(3)) ? $this->uri->segment(3) : 0;            $page = (($page*10)-10);            if($page<0)                $page = 0;        $data['records']=$this->Contact->select($config["per_page"],$page);        $data["links"] = $this->pagination->create_links();                $data["links"] = $this->pagination->create_links();        $data['title'] = 'إدارة الرسائل الواردة';        $data['metakeyword'] = 'الرسائل الواردة';        $data['metadiscription'] = '';        $data['subview'] = 'admin/contact/contact';        $this->load->view('index', $data);    }        public function delete_contact($id){        $this->load->model('Contact');        $this->Contact->delete($id);        redirect('dashboard/contact','refresh');    }        public function delete_selected_contact(){                 $this->load->model('Contact');        if($this->input->post('check') && $this->input->post('del')){                        foreach($_POST['check'] as $checked){                $this->Contact->delete($checked);            }                    }                redirect('dashboard/contact','refresh');           }    */                public function delete_selected_shakwa(){                 $this->load->model('Shakwa');        if($this->input->post('check') && $this->input->post('del')){                        foreach($_POST['check'] as $checked){                $this->Shakwa->delete($checked);            }                    }                redirect('dashboard/viewshakwa','refresh');           }        public function R_reserve(){        $this->load->model('P_booking');        $data['records']=$this->P_booking->select();        $data['title'] = 'تقرير الحجوزات.';                $data['metadiscription'] = '';      $data['subview'] = 'admin/apport/apport';        $this->load->view('index', $data);    }            /**  * *********************************************************************************  *   *                                 AHMAD  * **********************************************************************************  * */             ///////////////////////////////////////////////////////////////////////////reports//////////////// public function addreports(){        $this->load->model('Reports');        if ($this->input->post('add_report')){          $file_name='filee';            $file= $this->upload_file($file_name);            $this->Reports->insert($file);            $this->message('success','إضافةتقرير');            redirect('dashboard/addreports');        }        $config=$this->pagnate('addreports',$this->Reports->record_count(),50);        $data['records']=$this->Reports->select($config["per_page"]);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'إضافة تقرير';        $data['metakeyword'] = 'إعدادات التقارير السنوية';        $data['metadiscription'] = '';        $data['subview'] = 'admin/reports/reports';        $this->load->view('index', $data);    }                public function deletereports($id){        $this->load->model('Reports');       $this->Reports->delete($id);        redirect('dashboard/addreports');    }    public function updatereports($id){        $this->load->model('Reports');        if($this->input->post('update_report')){              $file_name='filee';           $file= $this->upload_file($file_name);            $this->Reports->update($id,$file);            $this->message('success','تعديل التقرير بنجاح');            redirect('dashboard/addreports','refresh');        }        $data['result']=$this->Reports->getById($id);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'تعديل تقرير';        $data['metakeyword'] = 'إعدادات  التقارير السنوية';        $data['metadiscription'] = '';        $data['subview'] = 'admin/reports/reports';        $this->load->view('index', $data);    }          public function suspendreports($id,$clas){        $this->load->model('Reports');                    $this->Reports->suspend($id,$clas);            if($clas == 'danger')            $this->message('success','التقرير نشط');            else            $this->message('success','التقرير غير نشط');            redirect('dashboard/addreports');    }              ///////////////////////////////////////////////////////////////////////////slider////////////////     public function addslider(){        $this->load->model('Slider');        if ($this->input->post('add_slider')){          $file_name='img';            $file= $this->upload_image($file_name);            $this->Slider->insert($file);            $this->message('success','إضافة صور ');            redirect('dashboard/addslider');        }        $config=$this->pagnate('addslider',$this->Slider->record_count(),50);        $data['records']=$this->Slider->select($config["per_page"]);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'إضافة الصور الرئيسية';        $data['metakeyword'] = 'إعدادات الصور الرئيسية';        $data['metadiscription'] = '';        $data['subview'] = 'admin/slider/slider';        $this->load->view('index', $data);    }                public function deleteslider($id){        $this->load->model('Slider');       $this->Slider->delete($id);        redirect('dashboard/addslider');    }    public function updateslider($id){        $this->load->model('Slider');        if($this->input->post('update_slider')){              $file_name='img';           $file= $this->upload_image($file_name);            $this->Slider->update($id,$file);            $this->message('success','تعديل الصور ');            redirect('dashboard/addslider','refresh');        }        $data['result']=$this->Slider->getById($id);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'تعديل صورة';        $data['metakeyword'] = 'إعدادات  الصور الرئيسية';        $data['metadiscription'] = '';        $data['subview'] = 'admin/slider/slider';        $this->load->view('index', $data);    }                      ///////////////////////////////////////////////////////////////////////////slider////////////////        public function addadver(){        $this->load->model('Advertising');        if ($this->input->post('add_adver')){          $file_name='img';            $file= $this->upload_image($file_name);            $this->Advertising->insert($file);            $this->message('success','إضافة إعلان خارجي');            redirect('dashboard/addadver');        }        $config=$this->pagnate('addadver',$this->Advertising->record_count(),50);        $data['records']=$this->Advertising->select($config["per_page"]);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'إضافة الإعلانات الخارجية';        $data['metakeyword'] = 'إعدادات الإعلانات الخارجية';        $data['metadiscription'] = '';        $data['subview'] = 'admin/advertising/advertising';        $this->load->view('index', $data);    }                public function deleteadver($id){        $this->load->model('Advertising');       $this->Advertising->delete($id);        redirect('dashboard/addadver');    }    public function updateadver($id){        $this->load->model('Advertising');        if($this->input->post('update_adver')){              $file_name='image';           $file= $this->upload_image($file_name);            $this->Advertising->update($id,$file);            $this->message('success','تعديل الإعلان الخارجي ');            redirect('dashboard/addadver','refresh');        }        $data['result']=$this->Advertising->getById($id);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'تعديل إعلان خارجي';        $data['metakeyword'] = 'إعدادات  الإعلانات الخارجية';        $data['metadiscription'] = '';        $data['subview'] = 'admin/advertising/advertising';        $this->load->view('index', $data);    }                     ///////////////////////////////////////////////////////////////////////////album////////////////        public function add_album(){        $this->load->model('Album');        if ($this->input->post('add_album')){                    for($x = 1 ; $x <= $this->input->post('photo_num') ; $x++)            {                $file_name='img'.$x;                $file[]= $this->upload_image($file_name);            }                        $this->Album->insert($file);            $this->message('success','إضافة صور');            redirect('dashboard/add_album','refresh');        }        $config=$this->pagnate('add_album',$this->Album->record_count(),50);        $data['records']=$this->Album->select($config["per_page"]);        if($this->input->post('num'))        {            if($this->input->post('num') != 0)            {                $data['result'] = $this->input->post('num');                $this->load->view('admin/album/photos', $data);            }        }        else{        $data["links"] = $this->pagination->create_links();        $data['title'] = 'إضافة صور';        $data['metakeyword'] = 'إعدادات مكتبة الصور';        $data['metadiscription'] = '';        $data['subview'] = 'admin/album/album';        $this->load->view('index', $data);        }    }    public function delete_album($id){        $this->load->model('Album');        $this->Album->delete($id);        redirect('dashboard/add_album','refresh');    }    public function update_album($id){        $this->load->model('Album');                if($this->input->post('update_album')){                        if($this->input->post('photo_num'))            {                if($this->input->post('photo_num') != 0)                {                    for($x = 1 ; $x <= $this->input->post('photo_num') ; $x++)                    {                        $file_name='img'.$x;                        $file[]= $this->upload_image($file_name);                    }                }            }            else                $file = '';                            $this->Album->update($id,$file);            $this->message('success','تعديل الصور');            redirect('dashboard/add_album','refresh');        }        $data['result']=$this->Album->getById($id);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'تعديل الصور';        $data['metakeyword'] = 'إعدادات مكتبة الصور';        $data['metadiscription'] = '';        $data['subview'] = 'admin/album/album';        $this->load->view('index', $data);    }      public function delete_photo_album($id,$index){        $this->load->model('Album');        $this->Album->delete_photo($id,$index);        redirect('dashboard/update_album/'.$id.'');    }        public function download($file)        {                $this->load->helper('download');        $name = $file;        $data = file_get_contents('./uploads/files/'.$file);         force_download($name, $data);             redirect('dashboard/addreports','refresh');        }                                          ////////////////////////////////////                  /** *  *  * video *  *  * */  public function add_video(){        $this->load->model('Video');        if ($this->input->post('add')){            $this->Video->insert();            $this->message('success','إضافة فيديو');            redirect('dashboard/add_video','refresh');        }        $data['records']=$this->Video->select(2);        $data['title'] = 'إضافة فيديو';        $data['metakeyword'] = 'إعدادات إدارة الفيديوهات';        $data['metadiscription'] = '';        $data['subview'] = 'admin/video/video';        $this->load->view('index', $data);    }    public function delete_video($id){        $this->load->model('Video');        $this->Video->delete($id);        redirect('dashboard/add_video');    }    public function update_video($id){        $this->load->model('Video');        if($this->input->post('update')){            $this->Video->update($id);            $this->message('success','تعديل فيديو');            redirect('dashboard/add_video','refresh');        }        $data['result']=$this->Video->getById($id);        $data['title'] = 'تعديل فيديو';        $data['metakeyword'] = 'إعدادات فيديو';        $data['metadiscription'] = '';        $data['subview'] = 'admin/video/video';        $this->load->view('index', $data);    }   //update_suspend_shakwa    public function delete_shakwa($id){        $this->load->model('Shakwa');        $this->Video->delete($id);        redirect('dashboard/viewshakwa');    }    public function suspend_shakwa($id){        $this->load->model('Shakwa');                    $this->Shakwa->readmessagebyid($id);                      redirect('dashboard/viewshakwa');    }   /*  public function add_doctors(){        $this->load->model('Doctors');        $data['sections']=$this->Doctors->get_depart();        $data['sec']=$this->Doctors->get_depart_name();        if ($this->input->post('add')){            $file=$this->upload_image('img');            $this->Doctors->insert($file);            $this->message('success','إضافة فيديو');            redirect('dashboard/add_doctors','refresh');        }        $data['records']=$this->Doctors->select();        $data['title'] = 'إضافة الأطباء';        $data['metakeyword'] = 'إعدادات إدارة الأطباء';        $data['metadiscription'] = '';        $data['subview'] = 'admin/doctors/doctors';        $this->load->view('index', $data);    }*/ public function add_doctor(){                $this->load->model('Doctors');              $this->load->model('Departs');               $this->load->model('Patient');          //  $this->load->model('Department');               if ($this->input->post('add')){                                $file_name6 ='id_number_img';                $file6 = $this->upload_image($file_name6);                $file_name7='medical_insurance_img';                $file7= $this->upload_image($file_name7);                $file_name8='insurance_professional_practice_img';                $file8= $this->upload_image($file_name8);                $file_name9='insurance_risk_img';                $file9= $this->upload_image($file_name9);                $file_name10='job_contract_img';                $file10= $this->upload_image($file_name10);                $file_name11='license_end_img';                $file11= $this->upload_image($file_name11);                $file_name12='rating_img';                $file12= $this->upload_image($file_name12);                //=================================end                            $file_name='decision_end_job';                $file = $this->upload_image($file_name);                                                                 $file_name2='insurance_professional_practice_attachment';                $file2 = $this->upload_file($file_name2);                $file_name3='job_contract';                $file3 = $this->upload_file($file_name3);                                  $this->Doctors->insert_doc($file,$file6,$file7,$file8,$file9,$file10,$file11,$file12,$file2,$file3);                $this->message('success','إضافة طبيب');                redirect('dashboard/add_doctor','refresh');            }else {               $data['records'] = $this->Doctors->select_doc_admin();               $data['departs']=$this->Patient->departs(2);                $data["links"] = $this->pagination->create_links();                $data['title'] = ' إضافة طبيب';                $data['metakeyword'] = '';                $data['metadiscription'] = '';                $data['subview'] = 'admin/doctors/add_doctor';                $this->load->view('index', $data);            }                       }                   public function update_doctor($id){                         $this->load->model('Doctors');              $this->load->model('Departs');               $this->load->model('Patient');            $this->load->model('Department');                      if ($this->input->post('update')){                                  $file_name='decision_end_job';                $file = $this->upload_image($file_name);                                       $file_name6 ='id_number_img';                $file6 = $this->upload_image($file_name6);                   $file_name7='medical_insurance_img';                $file7= $this->upload_image($file_name7);                $file_name8='insurance_professional_practice_img';                $file8= $this->upload_image($file_name8);                $file_name9='insurance_risk_img';                $file9= $this->upload_image($file_name9);                $file_name10='job_contract_img';                $file10= $this->upload_image($file_name10);                $file_name11='license_end_img';                $file11= $this->upload_image($file_name11);                $file_name12='rating_img';                $file12= $this->upload_image($file_name12);                                          $file_name2='insurance_professional_practice_attachment';                $file2 = $this->upload_file($file_name2);                $file_name3='job_contract';                $file3 = $this->upload_file($file_name3);                //=================================end              //  $this->Doctors->insert($file,$file2,$file3,$file6,$file7,$file8,$file9,$file10,$file11,$file12);            $this->Doctors->update_doc($file,$file6,$file7,$file8,$file9,$file10,$file11,$file12,$file2,$file3,$id);                $this->message('success','إضافة طبيب');                redirect('dashboard/add_doctor','refresh');            }else {                                 $data['result']=$this->Doctors->getById_admin($id);                $data['records'] = $this->Doctors->select_doc_admin();                $data['departs']=$this->Patient->departs(2);                $data["links"] = $this->pagination->create_links();                $data['title'] = ' إضافة طبيب';                $data['metakeyword'] = '';                $data['metadiscription'] = '';                $data['subview'] = 'admin/doctors/add_doctor';                $this->load->view('index', $data);            }        }                                       public function delete_doc($id){        $this->load->model('Doctors');        $this->Doctors->delete_doc($id);        redirect('dashboard/add_doctor');    } public function add_doctors(){            $this->load->model('Doctors');        $data['sections']=$this->Doctors->get_depart();        $data['sec']=$this->Doctors->get_depart_name();   if ($this->input->post('add')){              $file=$this->upload_image('img');            $this->Doctors->insert($file);            $this->message('success','إضافة بيانات الطبيب');            redirect('dashboard/add_doctors','refresh');                    }                       if($this->input->post('num')){      $this->load->view('admin/doctors/times');}else{        $data['records']=$this->Doctors->select();        $data['title'] = 'إضافة الأطباء';        $data['metakeyword'] = 'إعدادات إدارة الأطباء';        $data['metadiscription'] = '';        $data['subview'] = 'admin/doctors/doctors';        $this->load->view('index', $data);}            }    public function delete_Doctors($id){        $this->load->model('Doctors');        $this->Doctors->delete($id);        redirect('dashboard/add_doctors','refresh');    } /*   public function update_Doctors($id){        $this->load->model('Doctors');        $data['sections']=$this->Doctors->get_depart();        if($this->input->post('update')){            $file=$this->upload_image('img');            $this->Doctors->update($id,$file);            $this->message('success','تعديل الدكتور');            redirect('dashboard/add_doctors', 'refresh');        }        $data['result']=$this->Doctors->getById($id);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'تعديل دكتور';        $data['metakeyword'] = 'اعداددات إدارة الدكاترة ';        $data['metadiscription'] = '';        $data['subview'] = 'admin/doctors/doctors';        $this->load->view('index', $data);    }*/            public function update_Doctors($id){                     $this->load->model('Doctors');        $data['sections']=$this->Doctors->get_depart();        if($this->input->post('update')){            $file=$this->upload_image('img');             $this->Doctors->delete_group($id);            $this->Doctors->update($id,$file);                                                 $this->message('success','تعديل الدكتور');            redirect('dashboard/add_doctors', 'refresh');        }                        $data['result']=$this->Doctors->getById($id);        $data['times']=$this->Doctors->get_times($id);                $data["links"] = $this->pagination->create_links();        $data['title'] = 'تعديل دكتور';        $data['metakeyword'] = 'اعداددات إدارة الدكاترة ';        $data['metadiscription'] = '';        $data['subview'] = 'admin/doctors/doctors';        $this->load->view('index', $data);    }    public function suspend_doctors($id,$clas){        $this->load->model('Doctors');        $this->Doctors->suspend($id,$clas);        if($clas == 'danger')            $this->message('success','العمل نشط');        else            $this->message('success','العمل غير نشط');        redirect('dashboard/add_doctors');    }   public function viewmessage($id){        $this->load->model("Contact");        $this->load->model("Question");                if($_SESSION['role_id_fk'] == 1){            $data["result"]=$this->Contact->getmessagebyid($id);            $this->Contact->readmessagebyid($id);        }        elseif($_SESSION['role_id_fk'] == 3){            $data["result"]=$this->Question->getmessagebyid($id);            $this->Question->readmessagebyid($id);                           }        $data['title'] = 'عرض رسائل البريد الألكتروني';        $data['metakeyword'] = 'إعدادات البريد الألكتروني';        $data['metadiscription'] = '';        $data['subview'] = 'admin/contact/viewmessage';                $this->load->view('index',$data);            }    private  function sendmail($from,$name,$to=array(),$cc=false,$bcc=false,$subject,$message,$attach=false)    {$config['permitted_uri_chars'] = ''; $config['protocol'] = 'sendmail';$config['mailpath'] = '/usr/sbin/sendmail';$config['charset'] = 'iso-8859-1';$config['wordwrap'] = TRUE;        $this->load->library('email',$config);        $this->email->from($from, $name);        $this->email->to($to);        $this->email->cc($cc);        $this->email->bcc($bcc);        $this->email->subject($subject);        $this->email->message($message);        if(!$this->email->send())        {            //return show_error($this->email->print_debugger());             return false;        }        else        {           return true;        }    }    /** *  *     الأسئلة الواردة *  *  * */  public function question(){        $this->load->model('Question');        $this->load->model('Doctors');                $data['records']=$this->Question->select(0,'send');        $data['records2']=$this->Question->select(0,'all');                $data['doctors']=$this->Doctors->select_2();        $data['title'] = 'إدارة الأسئلة العامة';        $data['metakeyword'] = 'الأسئلة الواردة';        $data['metadiscription'] = '';        $data['subview'] = 'admin/question/question';        $this->load->view('index', $data);          }        public function read_question($id){                $this->load->model('Question');        $this->Question->update_m($id);        if($this->input->post('doc'.$id.''))        {            if($this->input->post('doc'.$id.'') != 'قم بإختيار الطبيب')                $this->message('success','التحويل');        }        else            $this->message('success','الرجوع');                         redirect('dashboard/question','refresh');                                           }        public function delete_question($id){        $this->load->model('Question');        $this->Question->delete($id);        redirect('dashboard/question','refresh');    }        public function delete_selected_question(){                 $this->load->model('Question');        if($this->input->post('check') && $this->input->post('del')){                        foreach($_POST['check'] as $checked){                $this->Question->delete($checked);            }                    }                redirect('dashboard/question','refresh');           }        public function send_answer($id)    {        $this->load->model('Question');                $this->Question->send_replay($id);                $name = 'مستشفى بانوراما';        $to = '';        $subject = 'الرد على سؤالك';        $message = $this->input->post('replay'.$id.'');                $this->sendmail($_SESSION['user_username'],$name,$to,'','',$subject,$message);                $this->message('success','إرسال الرد');                     redirect('dashboard/viewmessage/'.$id.'','refresh');    }    public function contact(){        $this->load->model('Contact');        $this->load->model('Question');                if($_SESSION['role_id_fk'] == 1){        $config=$this->pagnate('contact',$this->Contact->record_count(),10);        $page = ($this->uri->segment(3)) ? $this->uri->segment(3) : 0;            $page = (($page*10)-10);            if($page<0)                $page = 0;        $data['records']=$this->Contact->select($config["per_page"],$page);        $data["links"] = $this->pagination->create_links();        }                elseif($_SESSION['role_id_fk'] == 3){            $config=$this->pagnate('contact',$this->Question->record_count(),10);            $page = ($this->uri->segment(3)) ? $this->uri->segment(3) : 0;                $page = (($page*10)-10);                if($page<0)                    $page = 0;            $data['records']=$this->Question->select_question($_SESSION['doctor_id'],$config["per_page"],$page);            $data["links"] = $this->pagination->create_links();        }                $data['title'] = 'إدارة الرسائل الواردة';        $data['metakeyword'] = 'الرسائل الواردة';        $data['metadiscription'] = '';        $data['subview'] = 'admin/contact/contact';        $this->load->view('index', $data);    }        public function delete_contact($id){        $this->load->model('Contact');        $this->load->model('Question');                if($_SESSION['role_id_fk'] == 1)            $this->Contact->delete($id);                    elseif($_SESSION['role_id_fk'] == 3)            $this->Question->delete($id);                    redirect('dashboard/contact','refresh');    }        public function delete_selected_contact(){                 $this->load->model('Contact');         $this->load->model('Question');                 if($_SESSION['role_id_fk'] == 1){             if($this->input->post('check') && $this->input->post('del')){                                foreach($_POST['check'] as $checked){                    $this->Contact->delete($checked);                }                            }        }                elseif($_SESSION['role_id_fk'] == 3){             if($this->input->post('check') && $this->input->post('del')){                                foreach($_POST['check'] as $checked){                    $this->Question->delete($checked);                }                            }        }                redirect('dashboard/contact','refresh');           }                                /********************************************************/            public function career(){        $this->load->model('Career');        $config=$this->pagnate('career',$this->Career->record_count(),10);        $page = ($this->uri->segment(3)) ? $this->uri->segment(3) : 0;        $page = (($page*10)-10);        if($page<0)            $page = 0;        $data['records']=$this->Career->select($config["per_page"],$page);        $data["links"] = $this->pagination->create_links();        $data["links"] = $this->pagination->create_links();        $data['title'] = 'إدارة الرسائل الواردة';        $data['metakeyword'] = 'الرسائل الواردة';        $data['metadiscription'] = '';        $data['subview'] = 'admin/career/career';        $this->load->view('index', $data);    }    public function delete_career($id){        $this->load->model('Career');        $this->Career->delete($id);        redirect('dashboard/career','refresh');    }    public function delete_selected_career(){        $this->load->model('Career');        if($this->input->post('check') && $this->input->post('del')){            foreach($_POST['check'] as $checked){                $this->Career->delete($checked);            }        }        redirect('dashboard/career','refresh');    }    public function viewmessage1($id){        $this->load->model("Career");        $data["result"]=$this->Career->getmessagebyid($id);        $this->Career->readmessagebyid($id);        $data['title'] = 'عرض رسائل طلبات التوظيف';        $data['metakeyword'] = 'إعدادات طلبات التوظيف';        $data['metadiscription'] = '';        $data['subview'] = 'admin/career/viewmessage1';        $this->load->view('index',$data);                }           /*******************************************************/          public function details_times(){           $this->load->model('Apport');        $config=$this->pagnate('details_times',$this->Apport->record_count(),10);        $page = ($this->uri->segment(3)) ? $this->uri->segment(3) : 0;        $page = (($page*10)-10);        if($page<0)            $page = 0;              $this->load->model('Doctors');     $this->load->model('Departs');         $data['depart_id']=$this->Departs->select(1);    $data['doctor_id']=$this->Doctors->select_2();        $data['records']=$this->Apport->select($config["per_page"],$page);                $data['records2']=$this->Apport->times();        $data['records3']=$this->Apport->times_aprove(1);        $data['records4']=$this->Apport->times_aprove(0);        $data["links"] = $this->pagination->create_links();                    $data['title'] = 'عرض بيانات الحجوزات';        $data['metakeyword'] = 'إعدادات الحجوزات ';        $data['metadiscription'] = '';        $data['subview'] = 'admin/apport/details_times';        $this->load->view('index',$data);                  }                public function delete_times($id){        $this->load->model('Apport');        $this->Apport->delete($id);        redirect('dashboard/details_times','refresh');    }                public function suspend_times($id,$clas){        $this->load->model('Apport');                    $this->Apport->suspend($id,$clas);            if($clas == 'danger')            $this->message('success','موافق ');            else            $this->message('success','غير موافق');            redirect('dashboard/details_times');    }             public function add_jobs()     {        $this->load->model('Jobs_advert');                if($this->input->post('add'))        {            $this->Jobs_advert->insert();            $this->message('success','إضافة إعلان');            redirect('dashboard/add_jobs','refresh');        }        if($this->input->post('num'))        {            if($this->input->post('num') != 0)            {                $data['result'] = $this->input->post('num');                $this->load->view('admin/career/requires');            }        }        else        {            $data['records']=$this->Jobs_advert->select();            $data['title'] = 'إدارة إعلان وظائف';            $data['metakeyword'] = 'إعلان وظائف';            $data['metadiscription'] = '';            $data['subview'] = 'admin/career/jobs';            $this->load->view('index', $data);        }     }    public function update_jobs($id){        $this->load->model('Jobs_advert');        if($this->input->post('update')){            $this->Jobs_advert->update($id);            $this->message('success','تعديل إعلان الوظيفة');            redirect('dashboard/add_jobs','refresh');        }        $data['result']=$this->Jobs_advert->getById($id);        $data['title'] = 'تعديل إعلان الوظيفة';        $data['metakeyword'] = 'إعدادات إعلان الوظيفة';        $data['metadiscription'] = '';        $data['subview'] = 'admin/career/jobs';        $this->load->view('index', $data);    }        public function delete_requires($id,$index){        $this->load->model('Jobs_advert');        $this->Jobs_advert->delete($id,$index);        redirect('dashboard/update_jobs/'.$id.'');    }        public function suspend_job($id,$clas)    {        $this->load->model('Jobs_advert');                    $this->Jobs_advert->suspend($id,$clas);            if($clas == 'danger')            $this->message('success',' الوظيفة نشطة');            else            $this->message('success',' الوظيفة غير نشطة');            redirect('dashboard/add_jobs');        }              /**     *      * Patients     *      * */          public function patient()     {        $this->load->library('form_validation');        $this->load->model('Patient');        $this->load->model('Doctors');                if($this->input->post('add'))        {            $DB1 = $this->load->database('kingdom', TRUE);            $myvar = $this->input->post('code');                     //  $original_value = $DB1->query('SELECT code FROM patient WHERE `code` = '.$myvar )->result();                   $original_value =  $DB1->query("SELECT * FROM `patient` WHERE `code` = '.$myvar.'")->result();                      if(isset($original_value) && $original_value != null)                $value = $original_value[0]->code;            else                $value = '';                        if ($value == '')            {                $file_name='img';                $file= $this->upload_image($file_name);                $this->Patient->insert($file);                $this->message('success','إضافة بيانات مريض');            }            else                $this->message('error','لم تتم الإضافة رقم الملف موجود من قبل .. حاول مرة ثانية');                        //redirect('dashboard/patient','refresh');            $this->print_patient();        }        elseif($this->input->post('num')){            if($this->input->post('num') != 0){                $data['records'] = $this->Patient->search($this->input->post('num'));                $this->load->view('admin/patient/search_result', $data);            }        }        elseif($this->input->post('id')){            if($this->input->post('id') != ''){                $data['price'] = $this->Patient->price($this->input->post('id'),2);                $this->load->view('admin/patient/load_price', $data);            }        }        else{            //$DB1 = $this->load->database('kingdom', TRUE);            //$DB1->truncate('transformation');            //$DB1->truncate('operation');            //$DB1->truncate('payment');            //$DB1->truncate('patient');            $data['all_1']=$this->Patient->select(2,0,date("Y-m-d"),$_SESSION['dep_id']);            $data['records1']=$data['all_1'][0];            $data['all_2']=$this->Patient->select(2,0,'',$_SESSION['dep_id']);            $data['records2']=$data['all_2'][0];            $data['all_3']=$this->Patient->select(2,1,'',$_SESSION['dep_id']);            $data['records3']=$data['all_3'][0];            $data['records4']=$data['all_3'][1];            $data['records5']=$this->Patient->select_outdate(2,2,date("Y-m-d"),0,'');            $data['operation']=$this->Patient->all_operation(2);            $data['departs']=$this->Patient->departs(2);                        $data['doctors'] = $this->Doctors->select();                        $data['title'] = 'إضافة بيانات مريض';            $data['metakeyword'] = 'إضافة بيانات مريض';            $data['metadiscription'] = '';            $data['subview'] = 'admin/patient/patient';            $this->load->view('index', $data);        }     }          public function update_patient($id)     {        $this->load->model('Patient');        $this->load->model('Doctors');        if($this->input->post('update'))        {            $file_name='img';            $file= $this->upload_image($file_name);            $this->Patient->update($id,$file);            $this->message('success','تعديل بيانات مريض');            //redirect('dashboard/patient','refresh');            $this->print_patient();        }        else{            $data['result']=$this->Patient->getById($id);            $data['all_1']=$this->Patient->select(2,0,date("Y-m-d"),$_SESSION['dep_id']);            $data['records1']=$data['all_1'][0];            $data['all_2']=$this->Patient->select(2,0,'',$_SESSION['dep_id']);            $data['records2']=$data['all_2'][0];            $data['all_3']=$this->Patient->select(2,1,'',$_SESSION['dep_id']);            $data['records3']=$data['all_3'][0];            $data['records4']=$data['all_3'][1];            $data['records5']=$this->Patient->select_outdate(2,2,date("Y-m-d"),0,'');            $data['operation']=$this->Patient->all_operation(2);            $data['departs']=$this->Patient->departs(2);            $data['doctors']=$this->Doctors->select();            $data['title'] = 'إدارة المرضى';            $data['metakeyword'] = 'إدارة المرضى';            $data['metadiscription'] = '';            $data['subview'] = 'admin/patient/patient';            $this->load->view('index', $data);        }     }          public function delete_operation($id,$hash)     {        $this->load->model('Patient');        $this->Patient->delete($id);        redirect('dashboard/patient'.$hash.'');       }          public function checkout($check,$id,$page)     {        $this->load->model('Patient');                $array = explode('-',$id);                for($x = 0 ; $x < count($array) ; $x++)            if($array[$x] != '')                $this->Patient->checkout($check,$array[$x],0);                redirect('dashboard/'.$page.'');             }       public function exitt($t){         $this->load->model('Patient');        $array = explode('-',$this->input->post('data'.$t.''));        $array2 = explode('-',$this->input->post('paid'.$t.''));        if($this->input->post('payment'.$t.'') > 0)            $status = 1;        else            $status = 0;        for($x = 0 ; $x < count($array) ; $x++){            if($array[$x] != '')                if($x != 0)                    $this->Patient->exitt($this->input->post('check'),$array[$x],$array2[$x],$this->input->post('percentage'.$t.''),$status);                else                    $this->Patient->exitt($this->input->post('check'),$array[$x],$array2[$x],$this->input->post('percentage'.$t.''),$status);        }        if($status == 1){            $this->Patient->payment(2,$this->input->post('fatora_num'.$t.''),$this->input->post('payment'.$t.''),$this->input->post('after_dis'.$this->input->post('total'.$t.'').''),$this->input->post('patient_id'.$t.''),date("Y-m-d"),$this->input->post('total_paid'.$t.''),$this->input->post('other_medical'.$t.''));            $this->Patient->update_frist_payed($this->input->post('operation_id'.$t.''),$this->input->post('first_paid'.$t.''));                }        $this->print_fatora($this->input->post('fatora_num'.$t.''),$this->input->post('patient_id'.$t.''),2,$this->input->post('page'));     }       /*  public function exitt($t)     {        $this->load->model('Patient');                $array = explode('-',$this->input->post('data'.$t.''));        $array2 = explode('-',$this->input->post('paid'.$t.''));                if($this->input->post('payment'.$t.'') > 0)            $status = 1;        else            $status = 0;                for($x = 0 ; $x < count($array) ; $x++){            if($array[$x] != '')                if($x != 0)                    $this->Patient->exitt($this->input->post('check'),$array[$x],$array2[$x],$this->input->post('percentage'.$t.''),$status);                else                    $this->Patient->exitt($this->input->post('check'),$array[$x],'',$this->input->post('percentage'.$t.''),$status);        }                if($status == 1){            $this->Patient->payment(2,$this->input->post('fatora_num'.$t.''),$this->input->post('payment'.$t.''),$this->input->post('after_dis'.$this->input->post('total'.$t.'').''),$this->input->post('patient_id'.$t.''),date("Y-m-d"),$this->input->post('total_paid'.$t.''));        }                $this->print_fatora($this->input->post('fatora_num'.$t.''),$this->input->post('patient_id'.$t.''),2,$this->input->post('page'));             } */         /* public function print_fatora($fatora_num,$patient_id,$hosbital_id,$page){        $this->load->model('Patient');        $data['records']=$this->Patient->printt($hosbital_id,2,date("Y-m-d"),$patient_id,$fatora_num);        $data['departs']=$this->Patient->departs(2);        $data['operations'] = $this->Patient->all_operation(2);        $this->load->view('admin/patient/print', $data);     }*/          /******* 17-8-2017****/             public function print_fatora($fatora_num,$patient_id,$hosbital_id,$page){        $this->load->model('Patient');            $this->load->model('Payments');        $data["fatora"]=$this->Payments->get_pateint($patient_id,$fatora_num);                $data['records']=$this->Patient->printt($hosbital_id,2,date("Y-m-d"),$patient_id,$fatora_num);        $data['departs']=$this->Patient->departs(2);        $data['operations'] = $this->Patient->all_operation(2);        $this->load->view('admin/patient/print', $data);     }          /***************************/                    public function for_doctor()     {        $this->load->model('Patient');                if($this->input->post('add'.$this->input->post('id').''))        {            $tt = 0;            if(isset($_POST['to_dep'])){                $tt = $this->Patient->transform($this->input->post('id'));            }            $this->Patient->checkout(1,$this->input->post('id'),$tt);            $this->message('success','تمت الإضافة');            redirect('dashboard/for_doctor','refresh');        }                $data['all']=$this->Patient->select(2,0,'',$_SESSION['dep_id']);        $data['records']=$data['all'][0];                        $data['all_for_doc']=$this->Patient->select_for_doc_account(2,0,'',$_SESSION['dep_id'],$_SESSION['doctor_id']);         $data['records_for_doc']=$data['all_for_doc'][0];                 $data['departs']=$this->Patient->departs(2);        $data['departs2']=$this->Patient->departs_except(2);        $data['operations'] = $this->Patient->operation(2,$_SESSION['dep_id']);        $data['title'] = 'تفاصيل زيارة مريض';        $data['metakeyword'] = 'تفاصيل زيارة مريض';        $data['metadiscription'] = '';        $data['subview'] = 'admin/patient/for_doctor';        $this->load->view('index', $data);             }            public function select_for_doc_account($hospital_id,$inout,$date,$dep_id,$doc_id){                if($date != '')            $array = array('in/out'=>$inout,'operation_date'=>$date);        else            $array = array('in/out'=>$inout);        if($dep_id != 0)            $array['dep_id'] = $dep_id;        if($hospital_id != '')            $array['hospital_id'] = $hospital_id;                                    if($doc_id != '')            $array['re_doc_id'] = $_SESSION['doctor_id'];                   $DB1 = $this->load->database('kingdom', TRUE);                $DB1->select('operation.*,patient.a_name,patient.id AS p_id,patient.id_card,patient.mobile,patient.birth_date,patient.nationality,transformation.to_dep');                $DB1->join('patient','patient.id=operation.petient_id','left');                $DB1->join('transformation','transformation.id=operation.transform','left');                $DB1->where($array);                $query = $DB1->get('operation');                if ($query->num_rows() > 0) {            foreach ($query->result() as $row) {                $data[] = $row;                $data2[$row->id_card][$row->dep_id][] = $row;                $data3[$row->a_name][$row->operation_date][$row->dep_id][] = $row;                //$data3[$row->a_name][$row->operation_date][$row->dep_id][$row->out_date][] = $row;                $data4[$row->hospital_id][$row->id_card] = $row;            }            return array($data,$data2,$data3,$data4);        }        return false;    }                 public function patient_report()     {        $this->load->model('Patient');                $data['all']=$this->Patient->select(2,2,'',0);        $data['records']=$data['all'][3];        $data['all_patient'] = $this->Patient->all_patients();        $data['title'] = 'إجمالي العملاء';        $data['metakeyword'] = 'إدارة التقارير';        $data['metadiscription'] = '';        $data['subview'] = 'admin/patient/all_patients';        $this->load->view('index', $data);             }               public function visits_report()     {        $this->load->model('Patient');                $data['all']=$this->Patient->select(2,2,'',0);         $data['records']=$data['all'][2];        $data['departs']=$this->Patient->departs(2);        $data['operations'] = $this->Patient->all_operation(2);        $data['publisher'] = $this->Patient->users(2);        $data['title'] = 'جميع الزيارات';        $data['metakeyword'] = 'إدارة التقارير';        $data['metadiscription'] = '';        $data['subview'] = 'admin/patient/visits_report';        $this->load->view('index', $data);             }               public function visits_period()     {        $this->load->model('Patient');        if($this->input->post('date_from') && $this->input->post('date_to'))        {            $date_from = $this->input->post('date_from');            $date_to = $this->input->post('date_to');                        $data['records'] = $this->Patient->select_report(2,2,$date_from,$date_to,0);            $data['departs']=$this->Patient->departs(2);            $data['operations'] = $this->Patient->all_operation(2);            $data['publisher'] = $this->Patient->users(2);            $this->load->view('admin/patient/load_visits_period', $data);        }        else{            $data['title'] = 'الزيارات خلال فترة';            $data['metakeyword'] = 'إدارة التقارير';            $data['metadiscription'] = '';            $data['subview'] = 'admin/patient/visits_period';            $this->load->view('index', $data);        }             }               public function income_period()     {        $this->load->model('Patient');        if($this->input->post('date_from') && $this->input->post('date_to'))        {            $date_from = $this->input->post('date_from');            $date_to = $this->input->post('date_to');                        $data['departs']=$this->Patient->departs(2);            $data['operations'] = $this->Patient->all_operation(2);            $data['records'] = $this->Patient->income(2,2,$date_from,$date_to,0);            $data['records2'] = $this->Patient->income2(2,$date_from,$date_to);            $this->load->view('admin/patient/load_income_period', $data);        }        else{            $data['title'] = 'الإيرادات خلال فترة';            $data['metakeyword'] = 'إدارة التقارير';            $data['metadiscription'] = '';            $data['subview'] = 'admin/patient/income_period';            $this->load->view('index', $data);        }             }          public function sanad_sarf()     {        $this->load->model('Patient');        if($this->input->post('add'))        {            $fatora_num = $this->input->post('fatora_num');            $patient_id = $this->input->post('patient_id');            $payment = $this->input->post('paid');            $total = $this->input->post('remain');            $date = $this->input->post('out_date');            $id = $this->Patient->payment(2,$fatora_num,$payment,$total,$patient_id,$date,0);            $this->message('success','تمت الإضافة');            $this->print_sanad_sarf($id);        }        elseif($this->input->post('patient_id'))        {            if($this->input->post('patient_id') != '' || $this->input->post('patient_id') != ' ')            {                $data['records'] = $this->Patient->fatora(2,$this->input->post('patient_id'));                $this->load->view('admin/patient/load_fatora_select', $data);            }        }        elseif($this->input->post('fatora_num'))        {            if($this->input->post('fatora_num') != '')            {                $data['records2'] = $this->Patient->fatora_detais($this->input->post('fatora_num'));                $this->load->view('admin/patient/load_fatora_select2', $data);            }        }        else{            $data['patients'] = $this->Patient->all_patient(2);            $data['title'] = 'سندات القبض';            $data['metakeyword'] = 'إدارة الملف الألكتروني للمرضى';            $data['metadiscription'] = '';            $data['subview'] = 'admin/patient/sanad_sarf';            $this->load->view('index', $data);         }       }          public function delete_payment($id)     {        $this->load->model('Patient');        $this->Patient->delete_payment($id);        redirect('dashboard/sanad_sarf');       }          public function print_sanad_sarf($id)     {        $this->load->model('Patient');        $data['print'] = $this->Patient->print_sanad_sarf($id);        $data['arabic'] = $this->convert_number($data['print'][0]->paid);        $this->load->view('admin/patient/print_sanad_sarf', $data);     }          public function end_today()     {        $this->load->model('Patient');         $this->load->model('Payments');                $data['records5']=$this->Patient->select_outdate(2,2,date("Y-m-d"),0,'');        $data['operation']=$this->Patient->all_operation(2);        $data['departs']=$this->Patient->departs(2);        $data['opration_paid']=$this->Payments->get_opration_by_date(array("operation_date"=>date("Y-m-d",time())),2);        $data['title'] = 'الكشوفات المنتهية اليوم';        $data['metakeyword'] = 'إدارة الملف الألكتروني للمرضى';        $data['metadiscription'] = '';        $data['subview'] = 'admin/patient/end_today';        $this->load->view('index', $data);        }          public function out_patient()     {        $this->load->model('Patient');                $data['all_3']=$this->Patient->select(2,1,'',$_SESSION['dep_id']);        $data['records3']=$data['all_3'][0];        $data['records4']=$data['all_3'][1];        $data['operation']=$this->Patient->all_operation(2);        $data['departs']=$this->Patient->departs(2);                $data['title'] = 'الحساب النهائي للمريض';        $data['metakeyword'] = 'إدارة الملف الألكتروني للمرضى';        $data['metadiscription'] = '';        $data['subview'] = 'admin/patient/out_patient';        $this->load->view('index', $data);        }        /**     *      * Shereef     *      * */     public function print_patient(){        $this->load->model('Print_patient');        $data['prints']=$this->Print_patient->select();        $this->load->view('admin/patient/print_patient',$data);    }        public function payment_report(){        $this->load->model('Print_patient');        $data['reports']=$this->Print_patient->select_payment(2);        //echo '<pre>';var_dump($data['reports']);die;        $data['title'] = ' تقرير المديونيات';        $data['subview'] = 'admin/patient/payment_report';        $this->load->view('index', $data);    }        /**     *      * ARABIC     *      * */          public function convert_number($number)	{		$number=$number;		if (($number < 0) || ($number > 999999999999)) 		{ 			throw new Exception("العدد خارج النطاق");		}		$return="";		//convert number into array of (string) number each case		// -------number: 121210002876-----------//		// 	0		1		2		3  //		//'121'	  '210'	  '002'	  '876'		$english_format_number = number_format($number);		$array_number=explode(',', $english_format_number);		//convert each number(hundred) to arabic		for($i=0; $i<count($array_number); $i++){			$place=count($array_number) - $i;			$return .= $this->convert($array_number[$i], $place);			if(isset($array_number[($i + 1)]) && $array_number[($i + 1)]>0)  $return .= ' و';		}		return $return;	}	//private function	private function convert($number, $place, $sex="female"){		// take in charge the sex of NUMBERED		//$sex=$this->sex;		//the number word in arabic for masculine and feminine		$words = array(			'male'=>array(				'0'=> '' ,'1'=> 'واحد' ,'2'=> 'اثنان' ,'3' => 'ثلاثة','4' => 'أربعة','5' => 'خمسة',				'6' => 'ستة','7' => 'سبعة','8' => 'ثمانية','9' => 'تسعة','10' => 'عشرة',				'11' => 'أحد عشر','12' => 'اثنا عشر','13' => 'ثلاثة عشر','14' => 'أربعة عشر','15' => 'خمسة عشر',				'16' => 'ستة عشر','17' => 'سبعة عشر','18' => 'ثمانية عشر','19' => 'تسعة عشر','20' => 'عشرون',				'30' => 'ثلاثون','40' => 'أربعون','50' => 'خمسون','60' => 'ستون','70' => 'سبعون',				'80' => 'ثمانون','90' => 'تسعون', '100'=>'مئة', '200'=>'مئتان', '300'=>'ثلاثمئة', '400'=>'أربعمئة', '500'=>'خمسمئة',				'600'=>'ستمئة', '700'=>'سبعمئة', '800'=>'ثمانمئة', '900'=>'تسعمئة'			),			'female'=>array(				'0'=> '' ,'1'=> 'واحدة' ,'2'=> 'اثنتان' ,'3' => 'ثلاث','4' => 'أربع','5' => 'خمس',				'6' => 'ست','7' => 'سبع','8' => 'ثمان','9' => 'تسع','10' => 'عشر',				'11' => 'إحدى عشرة','12' => 'ثنتا عشرة','13' => 'ثلاث عشرة','14' => 'أربع عشرة','15' => 'خمس عشرة',				'16' => 'ست عشرة','17' => 'سبع عشرة','18' => 'ثمان عشرة','19' => 'تسع عشرة','20' => 'عشرون',				'30' => 'ثلاثون','40' => 'أربعون','50' => 'خمسون','60' => 'ستون','70' => 'سبعون',				'80' => 'ثمانون','90' => 'تسعون', '100'=>'مئة', '200'=>'مئتان', '300'=>'ثلاثمئة', '400'=>'أربعمئة', '500'=>'خمسمئة',				'600'=>'ستمئة', '700'=>'سبعمئة', '800'=>'ثمانمئة', '900'=>'تسعمئة'			)		);		//take in charge the different way of writing the thousands and millions ...		$mil = array(			'2'=>array('1'=>'ألف', '2'=>'ألفان', '3'=>'آلاف'), 			'3'=>array('1'=>'مليون', '2'=>'مليونان', '3'=>'ملايين'),			'4'=>array('1'=>'مليار', '2'=>'ملياران', '3'=>'مليارات')		);				$mf = array('1'=>$sex, '2'=>'male', '3'=>'male', '4'=>'male');		$number_length = strlen((string)$number);		if($number == 0) return '';		else if($number[0]==0){			if($number[1]==0) $number=(int)substr($number, -1);			else $number=(int)substr($number, -2);		}		 switch($number_length){			case '1': {				switch($place){					case '1':{						$return = $words[$mf[$place]][$number];					}					break;					case '2':{												if($number==1) $return = 'ألف';						else if($number==2) $return = 'ألفان';						else{							$return = $words[$mf[$place]][$number]. ' آلاف';						}					}					break;					case '3':{						if($number==1) $return = 'مليون';						else if($number==2) $return = 'مليونان';						else $return = $words[$mf[$place]][$number]. ' ملايين';					}					break;					case '4':{						if($number==1) $return = 'مليار';						else if($number==2) $return = 'ملياران';						else $return = $words[$mf[$place]][$number]. ' مليارات';					}					break;				}			}			break;			case '2': {				if(isset($words[$mf[$place]][$number])) $return = $words[$mf[$place]][$number];				else{					$twoy=$number[0] * 10;					$ony=$number[1];					$return = $words[$mf[$place]][$ony].' و'.$words[$mf[$place]][$twoy];				}				switch($place){					case '2':{						$return .= ' ألف';					}					break;					case '3':{						$return .= ' مليون';					}					break;					case '4':{						$return .= ' مليار';					}					break;				}			}			break;			case '3':{				if(isset($words[$mf[$place]][$number])){ 					$return = $words[$mf[$place]][$number];					if($number == 200) $return = 'مئتا';					switch($place){							case '2':{								$return .= ' ألف';							}							break;							case '3':{								$return .= ' مليون';							}							break;							case '4':{								$return .= ' مليار';							}							break;						}						return $return;				}				else{					$threey=$number[0] * 100;					if(isset($words[$mf[$place]][$threey])){						$return = $words[$mf[$place]][$threey];					}					$twoyony=$number[1] * 10 + $number[2];					if($twoyony==2){						switch($place){							case '1': $twoyony=$words[$mf[$place]]['2']; break;							case '2': $twoyony='ألفان'; break;							case '3': $twoyony='مليونان'; break;							case '4': $twoyony='ملياران'; break;						}						if($threey!=0){							$twoyony='و'.$twoyony;						}						$return = $return.' '.$twoyony;					}					else if($twoyony==1){						switch($place){							case '1': $twoyony=$words[$mf[$place]]['1']; break;							case '2': $twoyony='ألف'; break;							case '3': $twoyony='مليون'; break;							case '4': $twoyony='مليار'; break;						}						if($threey!=0){							$twoyony='و'.$twoyony;						}						$return = $return.' '.$twoyony;					}										else{						if(isset($words[$mf[$place]][$twoyony])) $twoyony = $words[$mf[$place]][$twoyony];						else{							$twoy=$number[1] * 10;							$ony=$number[2];							$twoyony = $words[$mf[$place]][$ony].' و'.$words[$mf[$place]][$twoy];						}						if($twoyony!='' && $threey!=0) $return= $return.' و'.$twoyony;						switch($place){							case '2':{								$return .= ' ألف';							}							break;							case '3':{								$return .= ' مليون';							}							break;							case '4':{								$return .= ' مليار';							}							break;						}					}					}			}			break;		}		return $return;	} /************************************************/       public function search (){        if ($this->input->post('name') ) {                         $this->load->model('Patient');          $data['query'] = $this->Patient->select_name($this->input->post('name'));                 $data['title'] = '';            $this->load->view('admin/search/get_search',$data);        }else{            $data['title'] = '';            $data['subview'] = 'admin/search/search';            $this->load->view('index', $data);        }                    /* $data['title'] = '';            $data['subview'] = 'admin/search/search';            $this->load->view('index', $data);*/            }    public function autocomplete(){     // load model     $this->load->model('Patient');     $search_data = $this->input->post('search_data');if($search_data){         $result = $this->Patient->select_name($search_data);     if (!empty($result))     {        echo ' <table class="table table-striped">    <thead>      <tr>                <th class="text-center">الإسم </th>             <th class="text-center">رقم الملف  </th>               <th class="text-center">رقم الهوية  </th>              <th class="text-center">رقم الجوال  </th>        </tr>    </thead>    <tbody>';          foreach ($result as $row):      echo '<tr class="text-center">                       <td class="text-center">'.$row->a_name.'</td>            <td class="text-center" >'.$row->code.'</td>            <td class="text-center">'.$row->id_card.'</td>                <td class="text-center">'.$row->mobile.'</td>            </tr>';           endforeach;          echo "    </tbody>  </table>";     }     else     {            echo '<div class="alert alert-danger">لا يوجد بيانات خاصة بهذا الإسم </div>';     }           } else{               $data['title'] = 'بحث عن مريض';    $data['subview'] = 'admin/search/test';            $this->load->view('index', $data);    }       }       public function search_mob(){         $this->load->model('Patient');     $search_data = $this->input->post('search_data');if($search_data){         $result = $this->Patient->select_mob($search_data);     if (!empty($result))     {        echo ' <table class="table table-striped">    <thead>      <tr>                <th class="text-center">الإسم </th>             <th class="text-center">رقم الملف  </th>               <th class="text-center">رقم الهوية  </th>              <th class="text-center">رقم الجوال  </th>        </tr>    </thead>    <tbody>';          foreach ($result as $row):      echo '<tr class="text-center">                       <td class="text-center">'.$row->a_name.'</td>            <td class="text-center" >'.$row->code.'</td>            <td class="text-center">'.$row->id_card.'</td>                <td class="text-center">'.$row->mobile.'</td>            </tr>';           endforeach;          echo "    </tbody>  </table>";     }     else     {            echo '<div class="alert alert-danger">لا يوجد بيانات خاصة بهذا الإسم </div>';     }           } else{               $data['title'] = 'بحث عن مريض';    $data['subview'] = 'admin/search/search_mob';            $this->load->view('index', $data);    }       }     /*********************************************************/    public function R_select_patient(){    $this->load->model('Patient');     $this->load->model('Reports');         $data['query_admin'] = $this->Patient->all_patients();    if ($this->input->post('account_code') && $this->input->post('account_code') != ''){            $data['code'] = $this->input->post('account_code');     $data['account']= $this->Reports->select_where($this->input->post('account_code'));    // $data['account']= $this->Reports->select_where();      $data['records']= $this->Reports->select_account($this->input->post('account_code'));        $this->load->view('admin/reports/get_select_patient',$data);    }    else{        $data['title'] = ' تقرير تفصيلي بفواتير مريض';        $data['subview'] = 'admin/reports/R_select_patient';        $this->load->view('index', $data);    }     } /***************4-8-2017********************/ public function patients_reservations(){    $this->load->model("Patients_reservations");    $data["depart"]=$this->Patients_reservations->get_departs();     if($this->input->post("ADD")){        $this->Patients_reservations->insert();         redirect('dashboard/patients_reservations', 'refresh');     }     //------------------------------//     $data["all_reservs_bydoc"]=$this->Patients_reservations->select_all_reservs_byday();     //------------------------------//     $data["records"]=$this->Patients_reservations->select();     //$this->test( $data["all_reservs_bydoc"]);       $data["all_reserved_after"]=$this->Patients_reservations->select_();   // $this->test($data["records"]);    $data["title"]='إضافة حجز جديد لمريض';     $data['subview'] = 'admin/patients_reservations/patients_reservations';     $this->load->view('index', $data);  } //------------------------------------------  public function update_patients_reservations($id){    $this->load->model("Patients_reservations");    $data["result"]=$this->Patients_reservations->getById($id);    $data["depart"]=$this->Patients_reservations->get_departs();    $data["doctors"]=$this->Patients_reservations->get_dep_doc($data["result"]['depart_id']);     if($this->input->post("UPDATE")){        $this->Patients_reservations->update($id);         redirect('dashboard/patients_reservations', 'refresh');     }      $data["title"]='تعديل حجز  لمريض';     $data['subview'] = 'admin/patients_reservations/patients_reservations';     $this->load->view('index', $data);  }       public function delete_reservations($id){        $this->load->model('Patients_reservations');        $this->Patients_reservations->delete_reservations($id);        redirect('dashboard/patients_reservations');    } //------------------------------------------ public function load(){     $this->load->model("Patients_reservations");    if($this->input->post("dep_id")){        $dep_id=$this->input->post("dep_id");             $data_load["doctors"]=$this->Patients_reservations->get_dep_doc($dep_id);      $this->load->view("admin/patients_reservations/load",$data_load);    }        if($this->input->post("nat_id")){        $nat_id=$this->input->post("nat_id");        $data_load["patient"]=$this->Patients_reservations->get_pat_name($nat_id);      $this->load->view("admin/patients_reservations/load2",$data_load);    }        if($this->input->post("reservations_time") && $this->input->post("doctor_id") && $this->input->post("reservations_date")){      $reservations_time=$this->input->post("reservations_time");      $reservations_date=$this->input->post("reservations_date");      $doctor_id=$this->input->post("doctor_id");      $data_load['chek']=$this->Patients_reservations->time_chek($reservations_time,$doctor_id,$reservations_date);      // $this->test($this->db->last_query());     $this->load->view("admin/patients_reservations/load3",$data_load);       } }//-----------------------------------------public function report_doctors_dally(){     $this->load->model("Patients_reservations");       $data['records']=$this->Patients_reservations->group_by_doctors();      $data['subview'] = 'admin/patients_reservations/doctors_dally';     $data['title'] =' تقرير الحجوزات  خلال اليوم';     $this->load->view('index', $data);} //-----------------------------------------public function report_one_doctors_dally(){      $this->load->model("Patients_reservations");      if($this->input->post("doctor_id")){        $doctor_id=$this->input->post("doctor_id");        $data_load["patients"]=$this->Patients_reservations->get_by_doc($doctor_id);      $this->load->view("admin/patients_reservations/load_report",$data_load);    }  else{           $data['title'] =' تقرير حجوزات خاص بكل طبيب';     $data['doctors']=$this->Patients_reservations->get_doc();       $data['subview'] = 'admin/patients_reservations/one_doctors_dally';     $this->load->view('index', $data);     }      }//----------------------------------------public function report_doctors_fatra(){      $this->load->model("Patients_reservations");      if($this->input->post("doctor_id")&& $this->input->post("date_from") && $this->input->post("date_to") ){        $doctor_id=$this->input->post("doctor_id");        $date_from=$this->input->post("date_from");        $date_to=$this->input->post("date_to");        $data_load["patients"]=$this->Patients_reservations->get_by_doc_ontime($doctor_id,$date_from,$date_to);     //$this->test($_POST );      $this->load->view("admin/patients_reservations/load_report2",$data_load);    }elseif(!$_POST){          $data['title'] =' تقرير حجوزات  خلال فترة ';     $data['doctors']=$this->Patients_reservations->get_doc();       $data['subview'] = 'admin/patients_reservations/report_fatra';     $this->load->view('index', $data);     }      }  /*public function single_doctor_reservations()     {           //$this->test($_SESSION['doctor_id']);          $this->load->model("Patients_reservations");           $data["patients"]=$this->Patients_reservations->all_doc_reservations($_SESSION['doctor_id']);          $data['title'] = 'حجوزات طبيب معين';        $data['metakeyword'] = 'حجوزات طبيب معين';        $data['metadiscription'] = '';        $data['subview'] = 'admin/patients_reservations/single_person_reservation';        $this->load->view('index', $data);       } */    public function single_doctor_reservations()    {        $this->load->model("Patients_reservations");        $data["patients"]=$this->Patients_reservations->all_doc_reservations($_SESSION['doctor_id']);        $data["all_cases_today"]=$this->Patients_reservations->select_today_cases($_SESSION['doctor_id']);        $data["all_cases_aftertoday"]=$this->Patients_reservations->select_aftertoday_cases($_SESSION['doctor_id']);        $data['title'] = 'حجوزات طبيب معين';        $data['metakeyword'] = 'حجوزات طبيب معين';        $data['metadiscription'] = '';        $data['subview'] = 'admin/patients_reservations/single_person_reservation';        $this->load->view('index', $data);    }//-----------------------------------------  public function for_doctor_test()     {        $this->load->model('Patient');                if($this->input->post('add'.$this->input->post('id').''))        {            $tt = 0;            if(isset($_POST['to_dep'])){                $tt = $this->Patient->transform($this->input->post('id'));            }            $this->Patient->checkout(1,$this->input->post('id'),$tt);            $this->message('success','تمت الإضافة');            redirect('dashboard/mytest','refresh');        }                $data['all']=$this->Patient->select(2,0,'',$_SESSION['dep_id']);        $data['records']=$data['all'][0];        $data['departs']=$this->Patient->departs(2);        $data['departs2']=$this->Patient->departs_except(2);        $data['operations'] = $this->Patient->operation(2,$_SESSION['dep_id']);        $data['title'] = 'تفاصيل زيارة مريض';        $data['metakeyword'] = 'تفاصيل زيارة مريض';        $data['metadiscription'] = '';        $data['subview'] = 'admin/patient/mytest';        $this->load->view('index', $data);             }                      /***********************************************/        public function AllPayment(){    $this->load->model('Patient');//Payments    $this->load->model('Payments');        $data["all_fatora"]=$this->Payments->select_fatora(2);        $data['title'] = 'تعديل فواتير المرضي ';        $data['metakeyword'] = 'تفاصيل فواتير المرضى ';        $data['metadiscription'] = '';        $data['subview'] = 'admin/patient/all_payment';        $this->load->view('index', $data);   }//-----------------------------------public function UpdatePayment($paitint_id,$fatora_id){ //get_pateint      $this->load->model('Patient');//Payments      $this->load->model('Payments');       if($this->input->post("ADD")){         $this->Payments->update_payment($paitint_id,$fatora_id);            redirect('dashboard/AllPayment', 'refresh');       }        $data['result']=$this->Payments->get_pateint($paitint_id,$fatora_id);        $data['title'] = 'تعديل الفاتورة';        $data['metakeyword'] = 'تعديل الفاتورة';        $data['metadiscription'] = '';        $data['subview'] = 'admin/patient/all_payment';        $this->load->view('index', $data);   }      public function rep(){                                $this->load->model('Patient');         $this->load->model('Payments');                $data['records5']=$this->Patient->select_outdate(2,2,date("Y-m-d"),0,'');        $data['operation']=$this->Patient->all_operation(2);        $data['departs']=$this->Patient->departs(2);        $data['opration_paid']=$this->Payments->get_opration_by_date(array("operation_date"=>date("Y-m-d",time())),2);             $data['title'] = 'الكشوفات المنتهية اليوم';        $data['metakeyword'] = 'إدارة الملف الألكتروني للمرضى';        $data['metadiscription'] = '';        $data['subview'] = 'admin/patient/end_today_2';        $this->load->view('index', $data);        }             /**     *     * المخازن     *     **/    public function add_storage(){        $this->load->model('storage/Storage');        if ($this->input->post('add')){            $this->Storage->insert();            $this->message('success','إضافة مخزن');            redirect('dashboard/add_storage','refresh');        }        $data['records']=$this->Storage->select();        $data['last'] = $this->Storage->select_last();        $data['title'] = 'إضافة مخزن';        $data['metakeyword'] = 'إعدادات مخزن';        $data['metadiscription'] = '';        $data['subview'] = 'admin/Storage/storage';        $this->load->view('index', $data);    }    public function delete_storage($id){        $this->load->model('storage/Storage');        $this->Storage->delete($id);        redirect('dashboard/add_storage');    }    public function update_storage($id){        $this->load->model('storage/Storage');        if($this->input->post('update')){            $this->Storage->update($id);            $this->message('success','تعديل مخزن بنجاح');            redirect('dashboard/add_storage','refresh');        }        $data['results']=$this->Storage->getById($id);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'تعديل مخزن';        $data['metakeyword'] = 'إعدادات المخازن';        $data['metadiscription'] = '';        $data['subview'] = 'admin/Storage/storage';        $this->load->view('index', $data);    }    public function add_unit(){        $this->load->model('storage/Unit');        if ($this->input->post('add')){            $this->Unit->insert();            $this->message('success','إضافة وحدات الاصناف');            redirect('dashboard/add_unit','refresh');        }        $data['records']=$this->Unit->select();        $data['title'] = 'إضافة وحدات الاصناف';        $data['metakeyword'] = 'إعدادات وحدات الاصناف';        $data['metadiscription'] = '';        $data['subview'] = 'admin/Storage/unit';        $this->load->view('index', $data);    }    public function delete_unit($id){        $this->load->model('storage/Unit');        $this->Unit->delete($id);        redirect('dashboard/add_unit');    }    public function update_unit($id){        $this->load->model('storage/Unit');        if($this->input->post('update')){            $this->Unit->update($id);            $this->message('success','تعديل وحدات الاصناف بنجاح');            redirect('dashboard/add_unit','refresh');        }        $data['results']=$this->Unit->getById($id);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'تعديل وحدات الاصناف';        $data['metakeyword'] = 'إعدادات وحدات الاصناف';        $data['metadiscription'] = '';        $data['subview'] = 'admin/Storage/unit';        $this->load->view('index', $data);    }    public function add_main_product(){        $this->load->model('storage/Main_product');        if ($this->input->post('add')){            $this->Main_product->insert();            $this->message('success','إضافة فئة الاصناف الرئيسية');            redirect('dashboard/add_main_product','refresh');        }        $data['records']=$this->Main_product->select();        $data['title'] = 'إضافة فئة الاصناف الرئيسية';        $data['metakeyword'] = 'إعدادات فئة الاصناف الرئيسية';        $data['metadiscription'] = '';        $data['subview'] = 'admin/Storage/main_product';        $this->load->view('index', $data);    }    public function delete_main_product($id){        $this->load->model('storage/Main_product');        $this->Main_product->delete($id);        redirect('dashboard/add_main_product');    }    public function update_main_product($id){        $this->load->model('storage/Main_product');        if($this->input->post('update')){            $this->Main_product->update($id);            $this->message('success','تعديل فئة الاصناف الرئيسية بنجاح');            redirect('dashboard/add_main_product','refresh');        }        $data['results']=$this->Main_product->getById($id);        $data["links"] = $this->pagination->create_links();        $data['title'] = 'تعديل فئة الاصناف الرئيسية';        $data['metakeyword'] = 'إعدادات فئة الاصناف الرئيسية';        $data['metadiscription'] = '';        $data['subview'] = 'admin/Storage/main_product';        $this->load->view('index', $data);    }    public function add_sub_product(){        $this->load->model('storage/Sub_product');        $data['count']=$this->Sub_product->select_count($this->input->post('p_storage_code_fk'));        if(isset($data['count'])&&$data['count']!=null){            if ($this->input->post('add')){                $this->Sub_product->insert($data['count'][0]->total);                $this->message('success','إضافة فئة الاصناف الفرعية');                redirect('dashboard/add_sub_product','refresh');            }        }else{            if ($this->input->post('add')){                $this->Sub_product->insert1();                $this->message('success','إضافة فئة الاصناف الفرعية');                redirect('dashboard/add_sub_product','refresh');            }        }        $data['records']=$this->Sub_product->select();        $data['stores']=$this->Sub_product->select_stores();        $data['main']=$this->Sub_product->select_main_product();        $data['units']=$this->Sub_product->select_units();        $data['title'] = 'إضافة فئة الاصناف الفرعية';        $data['metakeyword'] = 'إعدادات فئة الاصناف الفرعية';        $data['metadiscription'] = '';        $data['subview'] = 'admin/storagee/sub_product';        $this->load->view('index', $data);    }    public function delete_sub_product($id){        $this->load->model('storage/Sub_product');        $this->Sub_product->delete($id);        redirect('dashboard/add_sub_product');    }    public function update_sub_product($id){        $this->load->model('storage/Sub_product');        if($this->input->post('update')){            $this->Sub_product->update($id);            $this->message('success','تعديل فئة الاصناف الفرعية بنجاح');            redirect('dashboard/add_sub_product','refresh');        }        $data['results']=$this->Sub_product->getById($id);        $data['stores']=$this->Sub_product->select_stores();        $data['main']=$this->Sub_product->select_main_product();        $data['units']=$this->Sub_product->select_units();        $data["links"] = $this->pagination->create_links();        $data['title'] = 'تعديل فئة الاصناف الفرعية';        $data['metakeyword'] = 'إعدادات فئة الاصناف الفرعية';        $data['metadiscription'] = '';        $data['subview'] = 'admin/storagee/sub_product';        $this->load->view('index', $data);    }//---------------------------------------------------------------------------------------    public function add_subject()    { $this->load->model('Groups');     //$this->Groups->get_categories();      $data["results_main"]=$this->Groups->get_categories();        //$this->test($this->Groups->get_categories());        $this->load->view('admin/test',$data);    }//--------------------------- 15-10-2017 -----------------------------------------------public function visits_period_doc(){    $this->load->model('Patient');    $this->load->model('Difined_model');    $data['all_doctors'] = $this->Difined_model->select_all('doctor','','','','');    if($this->input->post('form_date') && $this->input->post('to_date') && $this->input->post('doctor'))    {        $date_from = $this->input->post('form_date');        $date_to = $this->input->post('to_date');        $doc_id = $this->input->post('doctor');        $data['records'] = $this->Patient->select_report2(2,2,$date_from,$date_to,0,$doc_id);        $data['departs']=$this->Patient->departs(2);        $data['operations'] = $this->Patient->all_operation(2);        $data['publisher'] = $this->Patient->users(2);        $this->load->view('admin/patient/load_visits_period_doc', $data);    }    else{        $data['title'] = 'الزيارات خلال فترة';        $data['metakeyword'] = 'إدارة التقارير';        $data['metadiscription'] = '';        $data['subview'] = 'admin/patient/visits_period_doc';        $this->load->view('index', $data);    }}//------------------------------------------------------------------------------------------   public function ReportDoctorsState(){       $this->load->model('Difined_model');       $this->load->model('Doctors');           if($this->input->post("date_from") && $this->input->post("date_to") && $this->input->post("doctor_id")){               $date_from = $this->input->post('date_from');               $date_to = $this->input->post('date_to');               $doctor_id = $this->input->post('doctor_id');                   if($doctor_id == "ALL"){                       $arr=array("operation_date >="=>$date_from,"operation_date <="=>$date_to);                    $data_load['all_doctors']=$this->Doctors->all_doctors_in($arr);                       $this->load->view('admin/reports/report_doctors_stata_load', $data_load);                   }else{                       $arr=array("operation_date >="=>$date_from,"operation_date <="=>$date_to,"re_doc_id"=>$doctor_id);                       $data_load['all_doctors']=$this->Doctors->one_doc_detals($arr);                       $this->load->view('admin/reports/report_doctors_stata_load_1', $data_load);                   }           }elseif(!$_POST){               $data['doctors']=$this->Difined_model->select_all("doctor","id","","id","DESC");               $data['title'] = 'تقرير بحالة الطبيب خلال فترة';               $data['metakeyword'] = 'تقرير بحالة الطبيب خلال فترة';               $data['metadiscription'] = 'تقرير بحالة الطبيب خلال فترة';               $data['subview'] = 'admin/reports/report_doctors_stata';               $this->load->view('index', $data);           }   }      public function payment_types(){         $this->load->model('Patient');         $data['cash'] = $this->Patient->fun_def(2,'payment','cash',0);         $data['card'] = $this->Patient->fun_def(2,'payment','card',0);         $data['atm'] = $this->Patient->fun_def(2,'payment','atm',0);          $data['cash_sum'] = $this->Patient->sum_(2,'payment','cash');          $data['atm_sum'] = $this->Patient->sum_(2,'payment','atm');          $data['card_sum'] = $this->Patient->sum_(2,'payment','card');               $data['records'] = $this->Patient->payments(2);               $data['title'] = 'تقرير انواع المدفوعات';               $data['metakeyword'] = ' تقرير انواع المدفوعات';               $data['metadiscription'] = 'تقرير انواع المدفوعات';               $data['subview'] = 'admin/reports/payment_types';               $this->load->view('index', $data);               }    //--------------------------------------------ahmed----------------------//    public function payment_types_period(){        $this->load->model('Patient');        if($this->input->post('form_date') && $this->input->post('to_date') /*&& $this->input->post('type')*/)        {            $data['type'] =$this->input->post('type');            $date_from = $this->input->post('form_date');            $date_to = $this->input->post('to_date');            $data['cash'] = $this->Patient->fun_def_period(2,'payment','cash',0,$date_from,$date_to);            $data['card'] = $this->Patient->fun_def_period(2,'payment','card',0,$date_from,$date_to);            $data['atm'] = $this->Patient->fun_def_period(2,'payment','atm',0,$date_from,$date_to);            $data['cash_sum'] = $this->Patient->sum_period(2,'payment','cash',$date_from,$date_to);            $data['atm_sum'] = $this->Patient->sum_period(2,'payment','atm',$date_from,$date_to);            $data['card_sum'] = $this->Patient->sum_period(2,'payment','card',$date_from,$date_to);            $data['records'] = $this->Patient->payments_period(2,$date_from,$date_to);            $this->load->view('admin/reports/get_payment_types_period', $data);        }else{        $data['title'] = 'تقرير انواع المدفوعات';        $data['metakeyword'] = ' تقرير انواع المدفوعات';        $data['metadiscription'] = 'تقرير انواع المدفوعات';        $data['subview'] = 'admin/reports/payment_types_period';        $this->load->view('index', $data);        }    }}//END CLASS 